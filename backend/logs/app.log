[2025-05-17 20:14:35,683] INFO in __init__: 应用已启动
[2025-05-17 20:14:43,049] INFO in __init__: 应用已启动
[2025-05-17 20:15:07,504] INFO in __init__: 应用已启动
[2025-05-17 20:17:10,311] INFO in __init__: 应用已启动
[2025-05-17 20:17:59,604] INFO in routes: 上传目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 20:17:59,604] INFO in routes: 保存PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/57dc6125-0e7f-44f8-a077-97c66e5f797c_wifi-dec.pcap
[2025-05-17 20:17:59,605] INFO in routes: PCAP文件已保存: /home/taoli/NIDS_ByTaoLi/backend/uploads/57dc6125-0e7f-44f8-a077-97c66e5f797c_wifi-dec.pcap, 大小: 65697 字节
[2025-05-17 20:17:59,606] INFO in routes: 已创建分析输出目录: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/57dc6125-0e7f-44f8-a077-97c66e5f797c
[2025-05-17 20:17:59,606] INFO in routes: 开始分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/57dc6125-0e7f-44f8-a077-97c66e5f797c_wifi-dec.pcap, 输出目录: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/57dc6125-0e7f-44f8-a077-97c66e5f797c
[2025-05-17 20:17:59,607] INFO in utils: 检查PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/57dc6125-0e7f-44f8-a077-97c66e5f797c_wifi-dec.pcap
[2025-05-17 20:17:59,607] INFO in utils: 检查PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/57dc6125-0e7f-44f8-a077-97c66e5f797c_wifi-dec.pcap
[2025-05-17 20:17:59,709] ERROR in routes: Suricata分析失败: Error: suricata: pcap file '/home/taoli/NIDS_ByTaoLi/backend/uploads/57dc6125-0e7f-44f8-a077-97c66e5f797c_wifi-dec.pcap': No such file or directory

[2025-05-17 20:17:59,709] ERROR in routes: Suricata分析失败: Suricata分析失败: Error: suricata: pcap file '/home/taoli/NIDS_ByTaoLi/backend/uploads/57dc6125-0e7f-44f8-a077-97c66e5f797c_wifi-dec.pcap': No such file or directory

[2025-05-17 20:19:55,362] INFO in __init__: 应用已启动
[2025-05-17 20:20:21,800] INFO in __init__: 应用已启动
[2025-05-17 20:20:30,145] INFO in __init__: 应用已启动
[2025-05-17 20:21:03,633] INFO in __init__: 应用已启动
[2025-05-17 20:27:25,216] INFO in __init__: 应用已启动
[2025-05-17 20:27:25,508] INFO in __init__: 应用已启动
[2025-05-17 20:29:16,854] INFO in __init__: 应用已启动
[2025-05-17 20:29:17,190] INFO in __init__: 应用已启动
[2025-05-17 20:29:33,662] INFO in routes: 上传目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 20:29:33,663] INFO in routes: 已创建分析输出目录: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/b9594a08-10e7-481f-9846-928d7ef2d3ee
[2025-05-17 20:29:33,663] INFO in routes: 保存PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/b9594a08-10e7-481f-9846-928d7ef2d3ee/original.pcap
[2025-05-17 20:29:33,664] INFO in routes: PCAP文件已保存: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/b9594a08-10e7-481f-9846-928d7ef2d3ee/original.pcap, 大小: 509929 字节
[2025-05-17 20:29:33,670] INFO in routes: 开始分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/b9594a08-10e7-481f-9846-928d7ef2d3ee/original.pcap, 输出目录: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/b9594a08-10e7-481f-9846-928d7ef2d3ee
[2025-05-17 20:29:33,670] INFO in routes: 使用Suricata分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/b9594a08-10e7-481f-9846-928d7ef2d3ee/original.pcap
[2025-05-17 20:29:33,670] INFO in routes: PCAP文件大小: 509929 字节
[2025-05-17 20:29:33,670] INFO in utils: 检查PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/b9594a08-10e7-481f-9846-928d7ef2d3ee/original.pcap
[2025-05-17 20:29:33,670] INFO in utils: 检查PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/b9594a08-10e7-481f-9846-928d7ef2d3ee/original.pcap
[2025-05-17 20:29:33,793] ERROR in routes: PCAP格式不兼容: PCAP文件包含Suricata不支持的数据链路类型，请使用标准的以太网捕获格式
[2025-05-17 20:29:33,793] INFO in utils: 尝试转换PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/b9594a08-10e7-481f-9846-928d7ef2d3ee/original.pcap -> /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/b9594a08-10e7-481f-9846-928d7ef2d3ee/converted.pcap
[2025-05-17 20:29:33,793] INFO in utils: 尝试转换PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/b9594a08-10e7-481f-9846-928d7ef2d3ee/original.pcap -> /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/b9594a08-10e7-481f-9846-928d7ef2d3ee/converted.pcap
[2025-05-17 20:29:33,793] ERROR in utils: 输入文件不存在: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/b9594a08-10e7-481f-9846-928d7ef2d3ee/original.pcap
[2025-05-17 20:29:33,793] ERROR in utils: 输入文件不存在: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/b9594a08-10e7-481f-9846-928d7ef2d3ee/original.pcap
[2025-05-17 20:29:33,793] ERROR in routes: Suricata分析失败: PCAP文件包含Suricata不支持的数据链路类型，请使用标准的以太网捕获格式。自动转换尝试失败: 输入文件不存在: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/b9594a08-10e7-481f-9846-928d7ef2d3ee/original.pcap
[2025-05-17 20:30:23,301] INFO in routes: 上传目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 20:30:23,302] INFO in routes: 已创建分析输出目录: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/dc6b9a03-6235-4035-89f4-35dcdb3e5d8f
[2025-05-17 20:30:23,302] INFO in routes: 保存PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/dc6b9a03-6235-4035-89f4-35dcdb3e5d8f/original.pcap
[2025-05-17 20:30:23,303] INFO in routes: PCAP文件已保存: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/dc6b9a03-6235-4035-89f4-35dcdb3e5d8f/original.pcap, 大小: 509929 字节
[2025-05-17 20:30:23,305] INFO in routes: 开始分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/dc6b9a03-6235-4035-89f4-35dcdb3e5d8f/original.pcap, 输出目录: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/dc6b9a03-6235-4035-89f4-35dcdb3e5d8f
[2025-05-17 20:30:23,305] INFO in routes: 使用Suricata分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/dc6b9a03-6235-4035-89f4-35dcdb3e5d8f/original.pcap
[2025-05-17 20:30:23,305] INFO in routes: PCAP文件大小: 509929 字节
[2025-05-17 20:30:23,305] INFO in utils: 检查PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/dc6b9a03-6235-4035-89f4-35dcdb3e5d8f/original.pcap
[2025-05-17 20:30:23,305] INFO in utils: 检查PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/dc6b9a03-6235-4035-89f4-35dcdb3e5d8f/original.pcap
[2025-05-17 20:30:23,388] ERROR in routes: PCAP格式不兼容: PCAP文件包含Suricata不支持的数据链路类型，请使用标准的以太网捕获格式
[2025-05-17 20:30:23,388] INFO in utils: 尝试转换PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/dc6b9a03-6235-4035-89f4-35dcdb3e5d8f/original.pcap -> /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/dc6b9a03-6235-4035-89f4-35dcdb3e5d8f/converted.pcap
[2025-05-17 20:30:23,388] INFO in utils: 尝试转换PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/dc6b9a03-6235-4035-89f4-35dcdb3e5d8f/original.pcap -> /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/dc6b9a03-6235-4035-89f4-35dcdb3e5d8f/converted.pcap
[2025-05-17 20:30:23,389] ERROR in utils: 输入文件不存在: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/dc6b9a03-6235-4035-89f4-35dcdb3e5d8f/original.pcap
[2025-05-17 20:30:23,389] ERROR in utils: 输入文件不存在: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/dc6b9a03-6235-4035-89f4-35dcdb3e5d8f/original.pcap
[2025-05-17 20:30:23,389] ERROR in routes: Suricata分析失败: PCAP文件包含Suricata不支持的数据链路类型，请使用标准的以太网捕获格式。自动转换尝试失败: 输入文件不存在: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/dc6b9a03-6235-4035-89f4-35dcdb3e5d8f/original.pcap
[2025-05-17 20:32:21,565] INFO in __init__: 应用已启动
[2025-05-17 20:32:46,977] INFO in __init__: 应用已启动
[2025-05-17 20:32:51,189] INFO in __init__: 应用已启动
[2025-05-17 20:33:27,596] INFO in __init__: 应用已启动
[2025-05-17 20:34:01,047] INFO in __init__: 应用已启动
[2025-05-17 20:35:57,488] INFO in routes: 上传目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 20:35:57,490] INFO in routes: 保存PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/1566aceb-09d3-4d32-8cbe-6c33cac253e4_wifi.pcap
[2025-05-17 20:35:57,492] INFO in routes: PCAP文件已保存: /home/taoli/NIDS_ByTaoLi/backend/uploads/1566aceb-09d3-4d32-8cbe-6c33cac253e4_wifi.pcap, 大小: 509929 字节
[2025-05-17 20:35:57,493] INFO in routes: 已创建分析输出目录: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/1566aceb-09d3-4d32-8cbe-6c33cac253e4
[2025-05-17 20:35:57,494] INFO in routes: 已将文件复制到分析目录: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/1566aceb-09d3-4d32-8cbe-6c33cac253e4/original.pcap
[2025-05-17 20:35:57,494] INFO in routes: 开始分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/1566aceb-09d3-4d32-8cbe-6c33cac253e4/original.pcap, 输出目录: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/1566aceb-09d3-4d32-8cbe-6c33cac253e4
[2025-05-17 20:35:57,494] INFO in routes: 使用Suricata分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/1566aceb-09d3-4d32-8cbe-6c33cac253e4/original.pcap
[2025-05-17 20:35:57,494] INFO in routes: PCAP文件大小: 509929 字节
[2025-05-17 20:35:57,494] INFO in utils: 检查PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/1566aceb-09d3-4d32-8cbe-6c33cac253e4/original.pcap
[2025-05-17 20:35:57,494] INFO in utils: 检查PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/1566aceb-09d3-4d32-8cbe-6c33cac253e4/original.pcap
[2025-05-17 20:35:57,495] INFO in utils: PCAP文件大小: 509929 字节
[2025-05-17 20:35:57,495] INFO in utils: PCAP文件大小: 509929 字节
[2025-05-17 20:35:57,495] INFO in utils: 执行命令: tcpdump -r /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/1566aceb-09d3-4d32-8cbe-6c33cac253e4/original.pcap -c 1 -nn
[2025-05-17 20:35:57,495] INFO in utils: 执行命令: tcpdump -r /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/1566aceb-09d3-4d32-8cbe-6c33cac253e4/original.pcap -c 1 -nn
[2025-05-17 20:35:57,499] INFO in utils: tcpdump stdout: 19:40:20.181733 Request-To-Send TA:50:bd:5f:7a:61:50 

[2025-05-17 20:35:57,499] INFO in utils: tcpdump stdout: 19:40:20.181733 Request-To-Send TA:50:bd:5f:7a:61:50 

[2025-05-17 20:35:57,499] INFO in utils: tcpdump stderr: reading from file /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/1566aceb-09d3-4d32-8cbe-6c33cac253e4/original.pcap, link-type IEEE802_11 (802.11), snapshot length 65535

[2025-05-17 20:35:57,499] INFO in utils: tcpdump stderr: reading from file /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/1566aceb-09d3-4d32-8cbe-6c33cac253e4/original.pcap, link-type IEEE802_11 (802.11), snapshot length 65535

[2025-05-17 20:35:57,500] INFO in utils: 执行命令: /usr/bin/suricata --pcap-file-continuous --pcap-file-delete -r /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/1566aceb-09d3-4d32-8cbe-6c33cac253e4/original.pcap -v
[2025-05-17 20:35:57,500] INFO in utils: 执行命令: /usr/bin/suricata --pcap-file-continuous --pcap-file-delete -r /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/1566aceb-09d3-4d32-8cbe-6c33cac253e4/original.pcap -v
[2025-05-17 20:35:57,659] INFO in utils: suricata stdout: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed, 0
Info: threshold-config: Threshold config parsed: 0 rule(s) found
Info: detect: 7 signatures processed. 0 are IP-only rules, 3 are inspecting packet payload, 1 inspect application layer, 0 are decoder event only
Warning: pcap: Failed to init pcap file /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/1566aceb-09d3-4d32-8cbe-6c33cac253e4/original.pcap, skipping
Notice: threads: Threads created -> RX: 1 W: 2 FM: 1 FR: 1   Engine started.
Notice: suricata: Signal Received.  Stopping engine.
Info: suricata: time elapsed 0.033s

[2025-05-17 20:35:57,659] INFO in utils: suricata stdout: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed, 0
Info: threshold-config: Threshold config parsed: 0 rule(s) found
Info: detect: 7 signatures processed. 0 are IP-only rules, 3 are inspecting packet payload, 1 inspect application layer, 0 are decoder event only
Warning: pcap: Failed to init pcap file /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/1566aceb-09d3-4d32-8cbe-6c33cac253e4/original.pcap, skipping
Notice: threads: Threads created -> RX: 1 W: 2 FM: 1 FR: 1   Engine started.
Notice: suricata: Signal Received.  Stopping engine.
Info: suricata: time elapsed 0.033s

[2025-05-17 20:35:57,661] INFO in utils: suricata stderr: Error: pcap: datalink type 105 not (yet) supported in module PcapFile.
Error: pcap: pcap file reader thread failed to initialize

[2025-05-17 20:35:57,661] INFO in utils: suricata stderr: Error: pcap: datalink type 105 not (yet) supported in module PcapFile.
Error: pcap: pcap file reader thread failed to initialize

[2025-05-17 20:35:57,661] ERROR in utils: Suricata不支持的数据链路类型: Error: pcap: datalink type 105 not (yet) supported in module PcapFile.
Error: pcap: pcap file reader thread failed to initialize

[2025-05-17 20:35:57,661] ERROR in utils: Suricata不支持的数据链路类型: Error: pcap: datalink type 105 not (yet) supported in module PcapFile.
Error: pcap: pcap file reader thread failed to initialize

[2025-05-17 20:35:57,661] ERROR in routes: PCAP格式不兼容: PCAP文件包含Suricata不支持的数据链路类型，请使用标准的以太网捕获格式
[2025-05-17 20:35:57,661] INFO in utils: 尝试转换PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/1566aceb-09d3-4d32-8cbe-6c33cac253e4/original.pcap -> /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/1566aceb-09d3-4d32-8cbe-6c33cac253e4/converted.pcap
[2025-05-17 20:35:57,661] INFO in utils: 尝试转换PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/1566aceb-09d3-4d32-8cbe-6c33cac253e4/original.pcap -> /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/1566aceb-09d3-4d32-8cbe-6c33cac253e4/converted.pcap
[2025-05-17 20:35:57,661] ERROR in utils: 输入文件不存在: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/1566aceb-09d3-4d32-8cbe-6c33cac253e4/original.pcap
[2025-05-17 20:35:57,661] ERROR in utils: 输入文件不存在: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/1566aceb-09d3-4d32-8cbe-6c33cac253e4/original.pcap
[2025-05-17 20:35:57,661] INFO in utils: 输入文件所在目录存在: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/1566aceb-09d3-4d32-8cbe-6c33cac253e4
[2025-05-17 20:35:57,661] INFO in utils: 输入文件所在目录存在: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/1566aceb-09d3-4d32-8cbe-6c33cac253e4
[2025-05-17 20:35:57,661] INFO in utils: 目录 /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/1566aceb-09d3-4d32-8cbe-6c33cac253e4 内容:
[2025-05-17 20:35:57,661] INFO in utils: 目录 /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/1566aceb-09d3-4d32-8cbe-6c33cac253e4 内容:
[2025-05-17 20:35:57,661] INFO in utils: 在父目录 /home/taoli/NIDS_ByTaoLi/backend/uploads/temp 中搜索相似文件:
[2025-05-17 20:35:57,661] INFO in utils: 在父目录 /home/taoli/NIDS_ByTaoLi/backend/uploads/temp 中搜索相似文件:
[2025-05-17 20:35:57,661] ERROR in routes: Suricata分析失败: PCAP文件包含Suricata不支持的数据链路类型，请使用标准的以太网捕获格式。自动转换尝试失败: 输入文件不存在: /home/taoli/NIDS_ByTaoLi/backend/uploads/temp/1566aceb-09d3-4d32-8cbe-6c33cac253e4/original.pcap
[2025-05-17 20:38:07,679] INFO in __init__: 应用已启动
[2025-05-17 20:38:18,953] INFO in __init__: 应用已启动
[2025-05-17 20:38:39,356] INFO in __init__: 应用已启动
[2025-05-17 20:41:39,552] INFO in __init__: 应用已启动
[2025-05-17 20:41:45,980] INFO in routes: 上传目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 20:41:45,980] INFO in routes: 保存PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/91dcb9e2-4a63-4f92-bfc2-f561d55e4a84_wifi.pcap
[2025-05-17 20:41:45,981] INFO in routes: PCAP文件已保存: /home/taoli/NIDS_ByTaoLi/backend/uploads/91dcb9e2-4a63-4f92-bfc2-f561d55e4a84_wifi.pcap, 大小: 509929 字节
[2025-05-17 20:41:45,983] INFO in routes: 开始分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/91dcb9e2-4a63-4f92-bfc2-f561d55e4a84_wifi.pcap, 输出目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 20:41:45,983] INFO in routes: 使用Suricata分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/91dcb9e2-4a63-4f92-bfc2-f561d55e4a84_wifi.pcap
[2025-05-17 20:41:45,983] INFO in routes: PCAP文件大小: 509929 字节
[2025-05-17 20:41:45,983] INFO in utils: 检查PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/91dcb9e2-4a63-4f92-bfc2-f561d55e4a84_wifi.pcap
[2025-05-17 20:41:45,983] INFO in utils: 检查PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/91dcb9e2-4a63-4f92-bfc2-f561d55e4a84_wifi.pcap
[2025-05-17 20:41:45,983] INFO in utils: PCAP文件大小: 509929 字节
[2025-05-17 20:41:45,983] INFO in utils: PCAP文件大小: 509929 字节
[2025-05-17 20:41:45,983] INFO in utils: 执行命令: tcpdump -r /home/taoli/NIDS_ByTaoLi/backend/uploads/91dcb9e2-4a63-4f92-bfc2-f561d55e4a84_wifi.pcap -c 1 -nn
[2025-05-17 20:41:45,983] INFO in utils: 执行命令: tcpdump -r /home/taoli/NIDS_ByTaoLi/backend/uploads/91dcb9e2-4a63-4f92-bfc2-f561d55e4a84_wifi.pcap -c 1 -nn
[2025-05-17 20:41:45,988] INFO in utils: tcpdump stdout: 19:40:20.181733 Request-To-Send TA:50:bd:5f:7a:61:50 

[2025-05-17 20:41:45,988] INFO in utils: tcpdump stdout: 19:40:20.181733 Request-To-Send TA:50:bd:5f:7a:61:50 

[2025-05-17 20:41:45,988] INFO in utils: tcpdump stderr: reading from file /home/taoli/NIDS_ByTaoLi/backend/uploads/91dcb9e2-4a63-4f92-bfc2-f561d55e4a84_wifi.pcap, link-type IEEE802_11 (802.11), snapshot length 65535

[2025-05-17 20:41:45,988] INFO in utils: tcpdump stderr: reading from file /home/taoli/NIDS_ByTaoLi/backend/uploads/91dcb9e2-4a63-4f92-bfc2-f561d55e4a84_wifi.pcap, link-type IEEE802_11 (802.11), snapshot length 65535

[2025-05-17 20:41:45,988] INFO in utils: 执行命令: /usr/bin/suricata --pcap-file-continuous --pcap-file-delete -r /home/taoli/NIDS_ByTaoLi/backend/uploads/91dcb9e2-4a63-4f92-bfc2-f561d55e4a84_wifi.pcap -v
[2025-05-17 20:41:45,988] INFO in utils: 执行命令: /usr/bin/suricata --pcap-file-continuous --pcap-file-delete -r /home/taoli/NIDS_ByTaoLi/backend/uploads/91dcb9e2-4a63-4f92-bfc2-f561d55e4a84_wifi.pcap -v
[2025-05-17 20:41:46,065] INFO in utils: suricata stdout: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed, 0
Info: threshold-config: Threshold config parsed: 0 rule(s) found
Info: detect: 7 signatures processed. 0 are IP-only rules, 3 are inspecting packet payload, 1 inspect application layer, 0 are decoder event only
Warning: pcap: Failed to init pcap file /home/taoli/NIDS_ByTaoLi/backend/uploads/91dcb9e2-4a63-4f92-bfc2-f561d55e4a84_wifi.pcap, skipping
Notice: threads: Threads created -> RX: 1 W: 2 FM: 1 FR: 1   Engine started.
Notice: suricata: Signal Received.  Stopping engine.
Info: suricata: time elapsed 0.019s

[2025-05-17 20:41:46,065] INFO in utils: suricata stdout: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed, 0
Info: threshold-config: Threshold config parsed: 0 rule(s) found
Info: detect: 7 signatures processed. 0 are IP-only rules, 3 are inspecting packet payload, 1 inspect application layer, 0 are decoder event only
Warning: pcap: Failed to init pcap file /home/taoli/NIDS_ByTaoLi/backend/uploads/91dcb9e2-4a63-4f92-bfc2-f561d55e4a84_wifi.pcap, skipping
Notice: threads: Threads created -> RX: 1 W: 2 FM: 1 FR: 1   Engine started.
Notice: suricata: Signal Received.  Stopping engine.
Info: suricata: time elapsed 0.019s

[2025-05-17 20:41:46,066] INFO in utils: suricata stderr: Error: pcap: datalink type 105 not (yet) supported in module PcapFile.
Error: pcap: pcap file reader thread failed to initialize

[2025-05-17 20:41:46,066] INFO in utils: suricata stderr: Error: pcap: datalink type 105 not (yet) supported in module PcapFile.
Error: pcap: pcap file reader thread failed to initialize

[2025-05-17 20:41:46,066] ERROR in utils: Suricata不支持的数据链路类型: Error: pcap: datalink type 105 not (yet) supported in module PcapFile.
Error: pcap: pcap file reader thread failed to initialize

[2025-05-17 20:41:46,066] ERROR in utils: Suricata不支持的数据链路类型: Error: pcap: datalink type 105 not (yet) supported in module PcapFile.
Error: pcap: pcap file reader thread failed to initialize

[2025-05-17 20:41:46,066] ERROR in routes: PCAP格式不兼容: PCAP文件包含Suricata不支持的数据链路类型，请使用标准的以太网捕获格式
[2025-05-17 20:41:46,066] INFO in utils: 尝试转换PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/91dcb9e2-4a63-4f92-bfc2-f561d55e4a84_wifi.pcap -> /home/taoli/NIDS_ByTaoLi/backend/uploads/converted.pcap
[2025-05-17 20:41:46,066] INFO in utils: 尝试转换PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/91dcb9e2-4a63-4f92-bfc2-f561d55e4a84_wifi.pcap -> /home/taoli/NIDS_ByTaoLi/backend/uploads/converted.pcap
[2025-05-17 20:41:46,066] ERROR in utils: 输入文件不存在: /home/taoli/NIDS_ByTaoLi/backend/uploads/91dcb9e2-4a63-4f92-bfc2-f561d55e4a84_wifi.pcap
[2025-05-17 20:41:46,066] ERROR in utils: 输入文件不存在: /home/taoli/NIDS_ByTaoLi/backend/uploads/91dcb9e2-4a63-4f92-bfc2-f561d55e4a84_wifi.pcap
[2025-05-17 20:41:46,066] ERROR in routes: Suricata分析失败: PCAP文件包含Suricata不支持的数据链路类型，请使用标准的以太网捕获格式。自动转换尝试失败: 输入文件不存在: /home/taoli/NIDS_ByTaoLi/backend/uploads/91dcb9e2-4a63-4f92-bfc2-f561d55e4a84_wifi.pcap
[2025-05-17 20:43:56,550] INFO in __init__: 应用已启动
[2025-05-17 20:44:21,934] INFO in __init__: 应用已启动
[2025-05-17 20:44:34,299] INFO in __init__: 应用已启动
[2025-05-17 20:44:50,608] INFO in __init__: 应用已启动
[2025-05-17 20:45:05,910] INFO in __init__: 应用已启动
[2025-05-17 20:45:26,628] INFO in __init__: 应用已启动
[2025-05-17 20:45:26,963] INFO in __init__: 应用已启动
[2025-05-17 20:45:54,195] INFO in routes: 上传目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 20:45:54,195] INFO in routes: 保存PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap
[2025-05-17 20:45:54,196] INFO in routes: PCAP文件已保存: /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap, 大小: 509929 字节
[2025-05-17 20:45:54,198] INFO in routes: 开始分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap, 输出目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 20:45:54,199] INFO in routes: 已创建PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap.bak
[2025-05-17 20:45:54,199] INFO in routes: 使用Suricata分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap
[2025-05-17 20:45:54,200] INFO in routes: PCAP文件大小: 509929 字节
[2025-05-17 20:45:54,200] INFO in utils: 检查PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap
[2025-05-17 20:45:54,200] INFO in utils: 检查PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap
[2025-05-17 20:45:54,200] INFO in utils: PCAP文件大小: 509929 字节
[2025-05-17 20:45:54,200] INFO in utils: PCAP文件大小: 509929 字节
[2025-05-17 20:45:54,200] INFO in utils: 执行命令: tcpdump -r /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap -c 1 -nn
[2025-05-17 20:45:54,200] INFO in utils: 执行命令: tcpdump -r /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap -c 1 -nn
[2025-05-17 20:45:54,204] INFO in utils: tcpdump stdout: 19:40:20.181733 Request-To-Send TA:50:bd:5f:7a:61:50 

[2025-05-17 20:45:54,204] INFO in utils: tcpdump stdout: 19:40:20.181733 Request-To-Send TA:50:bd:5f:7a:61:50 

[2025-05-17 20:45:54,204] INFO in utils: tcpdump stderr: reading from file /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap, link-type IEEE802_11 (802.11), snapshot length 65535

[2025-05-17 20:45:54,204] INFO in utils: tcpdump stderr: reading from file /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap, link-type IEEE802_11 (802.11), snapshot length 65535

[2025-05-17 20:45:54,205] INFO in utils: 执行命令: /usr/bin/suricata --pcap-file-continuous --pcap-file-delete -r /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap -v
[2025-05-17 20:45:54,205] INFO in utils: 执行命令: /usr/bin/suricata --pcap-file-continuous --pcap-file-delete -r /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap -v
[2025-05-17 20:45:54,284] INFO in utils: suricata stdout: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed, 0
Info: threshold-config: Threshold config parsed: 0 rule(s) found
Info: detect: 7 signatures processed. 0 are IP-only rules, 3 are inspecting packet payload, 1 inspect application layer, 0 are decoder event only
Warning: pcap: Failed to init pcap file /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap, skipping
Notice: threads: Threads created -> RX: 1 W: 2 FM: 1 FR: 1   Engine started.
Notice: suricata: Signal Received.  Stopping engine.
Info: suricata: time elapsed 0.015s

[2025-05-17 20:45:54,284] INFO in utils: suricata stdout: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed, 0
Info: threshold-config: Threshold config parsed: 0 rule(s) found
Info: detect: 7 signatures processed. 0 are IP-only rules, 3 are inspecting packet payload, 1 inspect application layer, 0 are decoder event only
Warning: pcap: Failed to init pcap file /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap, skipping
Notice: threads: Threads created -> RX: 1 W: 2 FM: 1 FR: 1   Engine started.
Notice: suricata: Signal Received.  Stopping engine.
Info: suricata: time elapsed 0.015s

[2025-05-17 20:45:54,284] INFO in utils: suricata stderr: Error: pcap: datalink type 105 not (yet) supported in module PcapFile.
Error: pcap: pcap file reader thread failed to initialize

[2025-05-17 20:45:54,284] INFO in utils: suricata stderr: Error: pcap: datalink type 105 not (yet) supported in module PcapFile.
Error: pcap: pcap file reader thread failed to initialize

[2025-05-17 20:45:54,285] ERROR in utils: Suricata不支持的数据链路类型: Error: pcap: datalink type 105 not (yet) supported in module PcapFile.
Error: pcap: pcap file reader thread failed to initialize

[2025-05-17 20:45:54,285] ERROR in utils: Suricata不支持的数据链路类型: Error: pcap: datalink type 105 not (yet) supported in module PcapFile.
Error: pcap: pcap file reader thread failed to initialize

[2025-05-17 20:45:54,285] ERROR in routes: PCAP格式不兼容: PCAP文件包含Suricata不支持的数据链路类型，请使用标准的以太网捕获格式
[2025-05-17 20:45:54,285] INFO in routes: 尝试将PCAP文件转换为: /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap
[2025-05-17 20:45:54,285] INFO in utils: 尝试转换PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap -> /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap
[2025-05-17 20:45:54,285] INFO in utils: 尝试转换PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap -> /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap
[2025-05-17 20:45:54,285] ERROR in utils: 输入文件不存在: /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap
[2025-05-17 20:45:54,285] ERROR in utils: 输入文件不存在: /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap
[2025-05-17 20:45:54,286] INFO in utils: 列出 /home/taoli/NIDS_ByTaoLi/backend/uploads 目录中的文件:
[2025-05-17 20:45:54,286] INFO in utils: 列出 /home/taoli/NIDS_ByTaoLi/backend/uploads 目录中的文件:
[2025-05-17 20:45:54,286] INFO in utils:   - 25c27e8b-f646-447c-bdcc-58b1943dffac_wifi.pcap
[2025-05-17 20:45:54,286] INFO in utils:   - 25c27e8b-f646-447c-bdcc-58b1943dffac_wifi.pcap
[2025-05-17 20:45:54,286] INFO in utils:   - 1566aceb-09d3-4d32-8cbe-6c33cac253e4_wifi.pcap
[2025-05-17 20:45:54,286] INFO in utils:   - 1566aceb-09d3-4d32-8cbe-6c33cac253e4_wifi.pcap
[2025-05-17 20:45:54,286] INFO in utils:   - 46d62e65-9ac5-4ab8-b29a-d9e4526802b4_wifi.pcap
[2025-05-17 20:45:54,286] INFO in utils:   - 46d62e65-9ac5-4ab8-b29a-d9e4526802b4_wifi.pcap
[2025-05-17 20:45:54,286] INFO in utils:   - cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap.bak
[2025-05-17 20:45:54,286] INFO in utils:   - cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap.bak
[2025-05-17 20:45:54,286] INFO in utils:   - temp
[2025-05-17 20:45:54,286] INFO in utils:   - temp
[2025-05-17 20:45:54,286] INFO in utils:   - 4a84d381-2c9a-4027-930d-a0d0e84bbf61_wifi.pcap
[2025-05-17 20:45:54,286] INFO in utils:   - 4a84d381-2c9a-4027-930d-a0d0e84bbf61_wifi.pcap
[2025-05-17 20:45:54,286] INFO in utils: 目录中共有 6 个文件
[2025-05-17 20:45:54,286] INFO in utils: 目录中共有 6 个文件
[2025-05-17 20:45:54,287] ERROR in routes: PCAP转换失败: 输入文件不存在: /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap
[2025-05-17 20:45:54,287] ERROR in routes: 原始文件已不存在: /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap
[2025-05-17 20:45:54,287] WARNING in routes: 原始文件丢失，尝试从备份恢复: /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap.bak
[2025-05-17 20:45:54,288] INFO in routes: 使用Suricata分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap
[2025-05-17 20:45:54,288] INFO in routes: PCAP文件大小: 509929 字节
[2025-05-17 20:45:54,288] INFO in utils: 检查PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap
[2025-05-17 20:45:54,288] INFO in utils: 检查PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap
[2025-05-17 20:45:54,288] INFO in utils: PCAP文件大小: 509929 字节
[2025-05-17 20:45:54,288] INFO in utils: PCAP文件大小: 509929 字节
[2025-05-17 20:45:54,289] INFO in utils: 执行命令: tcpdump -r /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap -c 1 -nn
[2025-05-17 20:45:54,289] INFO in utils: 执行命令: tcpdump -r /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap -c 1 -nn
[2025-05-17 20:45:54,291] INFO in utils: tcpdump stdout: 19:40:20.181733 Request-To-Send TA:50:bd:5f:7a:61:50 

[2025-05-17 20:45:54,291] INFO in utils: tcpdump stdout: 19:40:20.181733 Request-To-Send TA:50:bd:5f:7a:61:50 

[2025-05-17 20:45:54,292] INFO in utils: tcpdump stderr: reading from file /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap, link-type IEEE802_11 (802.11), snapshot length 65535

[2025-05-17 20:45:54,292] INFO in utils: tcpdump stderr: reading from file /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap, link-type IEEE802_11 (802.11), snapshot length 65535

[2025-05-17 20:45:54,292] INFO in utils: 执行命令: /usr/bin/suricata --pcap-file-continuous --pcap-file-delete -r /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap -v
[2025-05-17 20:45:54,292] INFO in utils: 执行命令: /usr/bin/suricata --pcap-file-continuous --pcap-file-delete -r /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap -v
[2025-05-17 20:45:54,362] INFO in utils: suricata stdout: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed, 0
Info: threshold-config: Threshold config parsed: 0 rule(s) found
Info: detect: 7 signatures processed. 0 are IP-only rules, 3 are inspecting packet payload, 1 inspect application layer, 0 are decoder event only
Warning: pcap: Failed to init pcap file /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap, skipping
Notice: threads: Threads created -> RX: 1 W: 2 FM: 1 FR: 1   Engine started.
Notice: suricata: Signal Received.  Stopping engine.
Info: suricata: time elapsed 0.014s

[2025-05-17 20:45:54,362] INFO in utils: suricata stdout: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed, 0
Info: threshold-config: Threshold config parsed: 0 rule(s) found
Info: detect: 7 signatures processed. 0 are IP-only rules, 3 are inspecting packet payload, 1 inspect application layer, 0 are decoder event only
Warning: pcap: Failed to init pcap file /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap, skipping
Notice: threads: Threads created -> RX: 1 W: 2 FM: 1 FR: 1   Engine started.
Notice: suricata: Signal Received.  Stopping engine.
Info: suricata: time elapsed 0.014s

[2025-05-17 20:45:54,363] INFO in utils: suricata stderr: Error: pcap: datalink type 105 not (yet) supported in module PcapFile.
Error: pcap: pcap file reader thread failed to initialize

[2025-05-17 20:45:54,363] INFO in utils: suricata stderr: Error: pcap: datalink type 105 not (yet) supported in module PcapFile.
Error: pcap: pcap file reader thread failed to initialize

[2025-05-17 20:45:54,363] ERROR in utils: Suricata不支持的数据链路类型: Error: pcap: datalink type 105 not (yet) supported in module PcapFile.
Error: pcap: pcap file reader thread failed to initialize

[2025-05-17 20:45:54,363] ERROR in utils: Suricata不支持的数据链路类型: Error: pcap: datalink type 105 not (yet) supported in module PcapFile.
Error: pcap: pcap file reader thread failed to initialize

[2025-05-17 20:45:54,363] ERROR in routes: PCAP格式不兼容: PCAP文件包含Suricata不支持的数据链路类型，请使用标准的以太网捕获格式
[2025-05-17 20:45:54,363] INFO in routes: 尝试将PCAP文件转换为: /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap
[2025-05-17 20:45:54,363] INFO in utils: 尝试转换PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap -> /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap
[2025-05-17 20:45:54,363] INFO in utils: 尝试转换PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap -> /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap
[2025-05-17 20:45:54,363] ERROR in utils: 输入文件不存在: /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap
[2025-05-17 20:45:54,363] ERROR in utils: 输入文件不存在: /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap
[2025-05-17 20:45:54,363] INFO in utils: 列出 /home/taoli/NIDS_ByTaoLi/backend/uploads 目录中的文件:
[2025-05-17 20:45:54,363] INFO in utils: 列出 /home/taoli/NIDS_ByTaoLi/backend/uploads 目录中的文件:
[2025-05-17 20:45:54,363] INFO in utils:   - 25c27e8b-f646-447c-bdcc-58b1943dffac_wifi.pcap
[2025-05-17 20:45:54,363] INFO in utils:   - 25c27e8b-f646-447c-bdcc-58b1943dffac_wifi.pcap
[2025-05-17 20:45:54,363] INFO in utils:   - 1566aceb-09d3-4d32-8cbe-6c33cac253e4_wifi.pcap
[2025-05-17 20:45:54,363] INFO in utils:   - 1566aceb-09d3-4d32-8cbe-6c33cac253e4_wifi.pcap
[2025-05-17 20:45:54,363] INFO in utils:   - 46d62e65-9ac5-4ab8-b29a-d9e4526802b4_wifi.pcap
[2025-05-17 20:45:54,363] INFO in utils:   - 46d62e65-9ac5-4ab8-b29a-d9e4526802b4_wifi.pcap
[2025-05-17 20:45:54,364] INFO in utils:   - cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap.bak
[2025-05-17 20:45:54,364] INFO in utils:   - cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap.bak
[2025-05-17 20:45:54,364] INFO in utils:   - temp
[2025-05-17 20:45:54,364] INFO in utils:   - temp
[2025-05-17 20:45:54,364] INFO in utils:   - 4a84d381-2c9a-4027-930d-a0d0e84bbf61_wifi.pcap
[2025-05-17 20:45:54,364] INFO in utils:   - 4a84d381-2c9a-4027-930d-a0d0e84bbf61_wifi.pcap
[2025-05-17 20:45:54,364] INFO in utils: 目录中共有 6 个文件
[2025-05-17 20:45:54,364] INFO in utils: 目录中共有 6 个文件
[2025-05-17 20:45:54,364] ERROR in routes: PCAP转换失败: 输入文件不存在: /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap
[2025-05-17 20:45:54,364] ERROR in routes: 原始文件已不存在: /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap
[2025-05-17 20:45:54,364] ERROR in routes: Suricata分析失败: PCAP文件包含Suricata不支持的数据链路类型，请使用标准的以太网捕获格式。自动转换尝试失败: 输入文件不存在: /home/taoli/NIDS_ByTaoLi/backend/uploads/cab84bef-a204-472a-8565-ca13964d7e26_wifi.pcap
[2025-05-17 20:46:43,727] INFO in __init__: 应用已启动
[2025-05-17 20:46:59,940] INFO in __init__: 应用已启动
[2025-05-17 20:47:00,282] INFO in __init__: 应用已启动
[2025-05-17 20:47:19,910] INFO in routes: 上传目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 20:47:19,911] INFO in routes: 保存PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap
[2025-05-17 20:47:19,911] INFO in routes: PCAP文件已保存: /home/taoli/NIDS_ByTaoLi/backend/uploads/3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap, 大小: 509929 字节
[2025-05-17 20:47:19,913] INFO in routes: 开始分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap, 输出目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 20:47:19,914] INFO in routes: 已创建PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap.bak
[2025-05-17 20:47:19,914] INFO in routes: 使用Suricata分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap
[2025-05-17 20:47:19,914] INFO in routes: PCAP文件大小: 509929 字节
[2025-05-17 20:47:19,914] INFO in utils: 检查PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap
[2025-05-17 20:47:19,914] INFO in utils: 检查PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap
[2025-05-17 20:47:19,914] INFO in utils: PCAP文件大小: 509929 字节
[2025-05-17 20:47:19,914] INFO in utils: PCAP文件大小: 509929 字节
[2025-05-17 20:47:19,914] INFO in utils: 执行命令: tcpdump -r /home/taoli/NIDS_ByTaoLi/backend/uploads/3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap -c 1 -nn
[2025-05-17 20:47:19,914] INFO in utils: 执行命令: tcpdump -r /home/taoli/NIDS_ByTaoLi/backend/uploads/3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap -c 1 -nn
[2025-05-17 20:47:19,919] INFO in utils: tcpdump stdout: 19:40:20.181733 Request-To-Send TA:50:bd:5f:7a:61:50 

[2025-05-17 20:47:19,919] INFO in utils: tcpdump stdout: 19:40:20.181733 Request-To-Send TA:50:bd:5f:7a:61:50 

[2025-05-17 20:47:19,920] INFO in utils: tcpdump stderr: reading from file /home/taoli/NIDS_ByTaoLi/backend/uploads/3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap, link-type IEEE802_11 (802.11), snapshot length 65535

[2025-05-17 20:47:19,920] INFO in utils: tcpdump stderr: reading from file /home/taoli/NIDS_ByTaoLi/backend/uploads/3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap, link-type IEEE802_11 (802.11), snapshot length 65535

[2025-05-17 20:47:19,920] INFO in utils: 执行命令: /usr/bin/suricata --pcap-file-continuous --pcap-file-delete -r /home/taoli/NIDS_ByTaoLi/backend/uploads/3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap -v
[2025-05-17 20:47:19,920] INFO in utils: 执行命令: /usr/bin/suricata --pcap-file-continuous --pcap-file-delete -r /home/taoli/NIDS_ByTaoLi/backend/uploads/3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap -v
[2025-05-17 20:47:19,996] INFO in utils: suricata stdout: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed, 0
Info: threshold-config: Threshold config parsed: 0 rule(s) found
Info: detect: 7 signatures processed. 0 are IP-only rules, 3 are inspecting packet payload, 1 inspect application layer, 0 are decoder event only
Warning: pcap: Failed to init pcap file /home/taoli/NIDS_ByTaoLi/backend/uploads/3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap, skipping
Notice: threads: Threads created -> RX: 1 W: 2 FM: 1 FR: 1   Engine started.
Notice: suricata: Signal Received.  Stopping engine.
Info: suricata: time elapsed 0.013s

[2025-05-17 20:47:19,996] INFO in utils: suricata stdout: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed, 0
Info: threshold-config: Threshold config parsed: 0 rule(s) found
Info: detect: 7 signatures processed. 0 are IP-only rules, 3 are inspecting packet payload, 1 inspect application layer, 0 are decoder event only
Warning: pcap: Failed to init pcap file /home/taoli/NIDS_ByTaoLi/backend/uploads/3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap, skipping
Notice: threads: Threads created -> RX: 1 W: 2 FM: 1 FR: 1   Engine started.
Notice: suricata: Signal Received.  Stopping engine.
Info: suricata: time elapsed 0.013s

[2025-05-17 20:47:19,996] INFO in utils: suricata stderr: Error: pcap: datalink type 105 not (yet) supported in module PcapFile.
Error: pcap: pcap file reader thread failed to initialize

[2025-05-17 20:47:19,996] INFO in utils: suricata stderr: Error: pcap: datalink type 105 not (yet) supported in module PcapFile.
Error: pcap: pcap file reader thread failed to initialize

[2025-05-17 20:47:19,997] ERROR in utils: Suricata不支持的数据链路类型: Error: pcap: datalink type 105 not (yet) supported in module PcapFile.
Error: pcap: pcap file reader thread failed to initialize

[2025-05-17 20:47:19,997] ERROR in utils: Suricata不支持的数据链路类型: Error: pcap: datalink type 105 not (yet) supported in module PcapFile.
Error: pcap: pcap file reader thread failed to initialize

[2025-05-17 20:47:19,997] ERROR in routes: PCAP格式不兼容: PCAP文件包含Suricata不支持的数据链路类型，请使用标准的以太网捕获格式
[2025-05-17 20:47:19,997] INFO in routes: 尝试将PCAP文件转换为: /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap
[2025-05-17 20:47:19,997] INFO in utils: 尝试转换PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap -> /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap
[2025-05-17 20:47:19,997] INFO in utils: 尝试转换PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap -> /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap
[2025-05-17 20:47:19,997] ERROR in utils: 输入文件不存在: /home/taoli/NIDS_ByTaoLi/backend/uploads/3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap
[2025-05-17 20:47:19,997] ERROR in utils: 输入文件不存在: /home/taoli/NIDS_ByTaoLi/backend/uploads/3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap
[2025-05-17 20:47:19,997] INFO in utils: 发现备份文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap.bak，尝试恢复
[2025-05-17 20:47:19,997] INFO in utils: 发现备份文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap.bak，尝试恢复
[2025-05-17 20:47:19,998] INFO in utils: 已从备份文件恢复: /home/taoli/NIDS_ByTaoLi/backend/uploads/3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap
[2025-05-17 20:47:19,998] INFO in utils: 已从备份文件恢复: /home/taoli/NIDS_ByTaoLi/backend/uploads/3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap
[2025-05-17 20:47:19,998] INFO in utils: 文件恢复成功，继续处理: /home/taoli/NIDS_ByTaoLi/backend/uploads/3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap
[2025-05-17 20:47:19,998] INFO in utils: 文件恢复成功，继续处理: /home/taoli/NIDS_ByTaoLi/backend/uploads/3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap
[2025-05-17 20:47:19,998] INFO in utils: 输入文件大小: 509929 字节
[2025-05-17 20:47:19,998] INFO in utils: 输入文件大小: 509929 字节
[2025-05-17 20:47:19,998] INFO in utils: 使用tcpdump转换格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap
[2025-05-17 20:47:19,998] INFO in utils: 使用tcpdump转换格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap
[2025-05-17 20:47:19,998] INFO in utils: 执行tcpdump转换命令: tcpdump -r /home/taoli/NIDS_ByTaoLi/backend/uploads/3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap -w /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap -s 0
[2025-05-17 20:47:19,998] INFO in utils: 执行tcpdump转换命令: tcpdump -r /home/taoli/NIDS_ByTaoLi/backend/uploads/3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap -w /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap -s 0
[2025-05-17 20:47:20,004] INFO in utils: PCAP文件转换成功: /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap, 大小: 509929 字节
[2025-05-17 20:47:20,004] INFO in utils: PCAP文件转换成功: /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap, 大小: 509929 字节
[2025-05-17 20:47:20,004] INFO in routes: 成功转换PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap -> /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap
[2025-05-17 20:47:20,004] INFO in routes: 执行Suricata命令: /usr/bin/suricata -c /etc/suricata/suricata.yaml -r /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_3c7fe478-81c9-4748-9577-7c67d5c161be_wifi.pcap --set outputs.eve-log.filename=/home/taoli/NIDS_ByTaoLi/backend/uploads/3c7fe478-81c9-4748-9577-7c67d5c161be_eve.json
[2025-05-17 20:47:21,134] INFO in routes: Suricata输出: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'

[2025-05-17 20:47:21,135] ERROR in routes: Suricata分析失败 (返回码 -11): 
[2025-05-17 20:47:21,135] ERROR in routes: Suricata分析失败: Suricata分析失败: 
[2025-05-17 20:48:50,093] INFO in __init__: 应用已启动
[2025-05-17 20:48:53,346] INFO in __init__: 应用已启动
[2025-05-17 20:50:06,120] INFO in __init__: 应用已启动
[2025-05-17 20:50:06,436] INFO in __init__: 应用已启动
[2025-05-17 20:50:24,706] INFO in routes: 上传目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 20:50:24,707] INFO in routes: 保存PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap
[2025-05-17 20:50:24,707] INFO in routes: PCAP文件已保存: /home/taoli/NIDS_ByTaoLi/backend/uploads/a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap, 大小: 509929 字节
[2025-05-17 20:50:24,709] INFO in routes: 开始分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap, 输出目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 20:50:24,710] INFO in routes: 已创建PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap.bak
[2025-05-17 20:50:24,710] INFO in routes: 使用Suricata分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap
[2025-05-17 20:50:24,710] INFO in routes: PCAP文件大小: 509929 字节
[2025-05-17 20:50:24,710] INFO in utils: 检查PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap
[2025-05-17 20:50:24,710] INFO in utils: 检查PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap
[2025-05-17 20:50:24,710] INFO in utils: PCAP文件大小: 509929 字节
[2025-05-17 20:50:24,710] INFO in utils: PCAP文件大小: 509929 字节
[2025-05-17 20:50:24,710] INFO in utils: 执行命令: tcpdump -r /home/taoli/NIDS_ByTaoLi/backend/uploads/a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap -c 1 -nn
[2025-05-17 20:50:24,710] INFO in utils: 执行命令: tcpdump -r /home/taoli/NIDS_ByTaoLi/backend/uploads/a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap -c 1 -nn
[2025-05-17 20:50:24,714] INFO in utils: tcpdump stdout: 19:40:20.181733 Request-To-Send TA:50:bd:5f:7a:61:50 

[2025-05-17 20:50:24,714] INFO in utils: tcpdump stdout: 19:40:20.181733 Request-To-Send TA:50:bd:5f:7a:61:50 

[2025-05-17 20:50:24,714] INFO in utils: tcpdump stderr: reading from file /home/taoli/NIDS_ByTaoLi/backend/uploads/a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap, link-type IEEE802_11 (802.11), snapshot length 65535

[2025-05-17 20:50:24,714] INFO in utils: tcpdump stderr: reading from file /home/taoli/NIDS_ByTaoLi/backend/uploads/a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap, link-type IEEE802_11 (802.11), snapshot length 65535

[2025-05-17 20:50:24,714] INFO in utils: 执行命令: /usr/bin/suricata --pcap-file-continuous --pcap-file-delete -r /home/taoli/NIDS_ByTaoLi/backend/uploads/a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap -v
[2025-05-17 20:50:24,714] INFO in utils: 执行命令: /usr/bin/suricata --pcap-file-continuous --pcap-file-delete -r /home/taoli/NIDS_ByTaoLi/backend/uploads/a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap -v
[2025-05-17 20:50:24,790] INFO in utils: suricata stdout: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed, 0
Info: threshold-config: Threshold config parsed: 0 rule(s) found
Info: detect: 7 signatures processed. 0 are IP-only rules, 3 are inspecting packet payload, 1 inspect application layer, 0 are decoder event only
Warning: pcap: Failed to init pcap file /home/taoli/NIDS_ByTaoLi/backend/uploads/a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap, skipping
Notice: threads: Threads created -> RX: 1 W: 2 FM: 1 FR: 1   Engine started.
Notice: suricata: Signal Received.  Stopping engine.
Info: suricata: time elapsed 0.016s

[2025-05-17 20:50:24,790] INFO in utils: suricata stdout: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed, 0
Info: threshold-config: Threshold config parsed: 0 rule(s) found
Info: detect: 7 signatures processed. 0 are IP-only rules, 3 are inspecting packet payload, 1 inspect application layer, 0 are decoder event only
Warning: pcap: Failed to init pcap file /home/taoli/NIDS_ByTaoLi/backend/uploads/a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap, skipping
Notice: threads: Threads created -> RX: 1 W: 2 FM: 1 FR: 1   Engine started.
Notice: suricata: Signal Received.  Stopping engine.
Info: suricata: time elapsed 0.016s

[2025-05-17 20:50:24,791] INFO in utils: suricata stderr: Error: pcap: datalink type 105 not (yet) supported in module PcapFile.
Error: pcap: pcap file reader thread failed to initialize

[2025-05-17 20:50:24,791] INFO in utils: suricata stderr: Error: pcap: datalink type 105 not (yet) supported in module PcapFile.
Error: pcap: pcap file reader thread failed to initialize

[2025-05-17 20:50:24,791] ERROR in utils: Suricata不支持的数据链路类型: Error: pcap: datalink type 105 not (yet) supported in module PcapFile.
Error: pcap: pcap file reader thread failed to initialize

[2025-05-17 20:50:24,791] ERROR in utils: Suricata不支持的数据链路类型: Error: pcap: datalink type 105 not (yet) supported in module PcapFile.
Error: pcap: pcap file reader thread failed to initialize

[2025-05-17 20:50:24,791] ERROR in routes: PCAP格式不兼容: PCAP文件包含Suricata不支持的数据链路类型，请使用标准的以太网捕获格式
[2025-05-17 20:50:24,791] INFO in routes: 尝试将PCAP文件转换为: /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap
[2025-05-17 20:50:24,791] INFO in utils: 尝试转换PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap -> /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap
[2025-05-17 20:50:24,791] INFO in utils: 尝试转换PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap -> /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap
[2025-05-17 20:50:24,791] ERROR in utils: 输入文件不存在: /home/taoli/NIDS_ByTaoLi/backend/uploads/a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap
[2025-05-17 20:50:24,791] ERROR in utils: 输入文件不存在: /home/taoli/NIDS_ByTaoLi/backend/uploads/a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap
[2025-05-17 20:50:24,791] INFO in utils: 发现备份文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap.bak，尝试恢复
[2025-05-17 20:50:24,791] INFO in utils: 发现备份文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap.bak，尝试恢复
[2025-05-17 20:50:24,792] INFO in utils: 已从备份文件恢复: /home/taoli/NIDS_ByTaoLi/backend/uploads/a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap
[2025-05-17 20:50:24,792] INFO in utils: 已从备份文件恢复: /home/taoli/NIDS_ByTaoLi/backend/uploads/a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap
[2025-05-17 20:50:24,793] INFO in utils: 文件恢复成功，继续处理: /home/taoli/NIDS_ByTaoLi/backend/uploads/a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap
[2025-05-17 20:50:24,793] INFO in utils: 文件恢复成功，继续处理: /home/taoli/NIDS_ByTaoLi/backend/uploads/a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap
[2025-05-17 20:50:24,793] INFO in utils: 输入文件大小: 509929 字节
[2025-05-17 20:50:24,793] INFO in utils: 输入文件大小: 509929 字节
[2025-05-17 20:50:24,793] INFO in utils: 使用tcpdump转换格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap
[2025-05-17 20:50:24,793] INFO in utils: 使用tcpdump转换格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap
[2025-05-17 20:50:24,793] INFO in utils: 执行tcpdump转换命令: tcpdump -r /home/taoli/NIDS_ByTaoLi/backend/uploads/a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap -w /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap -s 0
[2025-05-17 20:50:24,793] INFO in utils: 执行tcpdump转换命令: tcpdump -r /home/taoli/NIDS_ByTaoLi/backend/uploads/a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap -w /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap -s 0
[2025-05-17 20:50:24,799] INFO in utils: 尝试使用editcap转换为以太网格式: editcap -T ether /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap.ether
[2025-05-17 20:50:24,799] INFO in utils: 尝试使用editcap转换为以太网格式: editcap -T ether /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap.ether
[2025-05-17 20:50:24,812] INFO in utils: 使用editcap成功转换为以太网格式
[2025-05-17 20:50:24,812] INFO in utils: 使用editcap成功转换为以太网格式
[2025-05-17 20:50:24,812] INFO in utils: PCAP文件转换成功: /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap, 大小: 752064 字节
[2025-05-17 20:50:24,812] INFO in utils: PCAP文件转换成功: /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap, 大小: 752064 字节
[2025-05-17 20:50:24,815] INFO in utils: 转换后文件类型: /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap: pcapng capture file - version 1.0

[2025-05-17 20:50:24,815] INFO in utils: 转换后文件类型: /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap: pcapng capture file - version 1.0

[2025-05-17 20:50:24,815] INFO in routes: 成功转换PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap -> /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap
[2025-05-17 20:50:24,816] INFO in routes: 执行Suricata命令: /usr/bin/suricata -c /etc/suricata/suricata.yaml -r /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_wifi.pcap --set outputs.eve-log.filename=/home/taoli/NIDS_ByTaoLi/backend/uploads/a78de8cd-3dc2-40cd-a3f7-3a93cbd68288_eve.json
[2025-05-17 20:50:25,941] INFO in routes: Suricata输出: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'

[2025-05-17 20:50:25,942] ERROR in routes: Suricata分析失败 (返回码 -11): 
[2025-05-17 20:50:25,942] ERROR in routes: Suricata分析失败: Suricata分析失败: 
[2025-05-17 20:51:06,438] INFO in routes: 上传目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 20:51:06,438] INFO in routes: 保存PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/cd40542d-8c8a-4348-894d-240393321f6d_APTbadnews.pcapng
[2025-05-17 20:51:06,439] INFO in routes: PCAP文件已保存: /home/taoli/NIDS_ByTaoLi/backend/uploads/cd40542d-8c8a-4348-894d-240393321f6d_APTbadnews.pcapng, 大小: 52980 字节
[2025-05-17 20:51:06,440] INFO in routes: 开始分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/cd40542d-8c8a-4348-894d-240393321f6d_APTbadnews.pcapng, 输出目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 20:51:06,440] INFO in routes: 已创建PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/cd40542d-8c8a-4348-894d-240393321f6d_APTbadnews.pcapng.bak
[2025-05-17 20:51:06,440] INFO in routes: 使用Suricata分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/cd40542d-8c8a-4348-894d-240393321f6d_APTbadnews.pcapng
[2025-05-17 20:51:06,440] INFO in routes: PCAP文件大小: 52980 字节
[2025-05-17 20:51:06,440] INFO in utils: 检查PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/cd40542d-8c8a-4348-894d-240393321f6d_APTbadnews.pcapng
[2025-05-17 20:51:06,440] INFO in utils: 检查PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/cd40542d-8c8a-4348-894d-240393321f6d_APTbadnews.pcapng
[2025-05-17 20:51:06,441] INFO in utils: PCAP文件大小: 52980 字节
[2025-05-17 20:51:06,441] INFO in utils: PCAP文件大小: 52980 字节
[2025-05-17 20:51:06,441] INFO in utils: 执行命令: tcpdump -r /home/taoli/NIDS_ByTaoLi/backend/uploads/cd40542d-8c8a-4348-894d-240393321f6d_APTbadnews.pcapng -c 1 -nn
[2025-05-17 20:51:06,441] INFO in utils: 执行命令: tcpdump -r /home/taoli/NIDS_ByTaoLi/backend/uploads/cd40542d-8c8a-4348-894d-240393321f6d_APTbadnews.pcapng -c 1 -nn
[2025-05-17 20:51:06,445] INFO in utils: tcpdump stdout: 19:56:22.352903 IP 169.254.216.11.53121 > 169.254.144.149.80: Flags [S], seq 1939890441, win 65535, options [mss 1460,nop,wscale 8,nop,nop,sackOK], length 0

[2025-05-17 20:51:06,445] INFO in utils: tcpdump stdout: 19:56:22.352903 IP 169.254.216.11.53121 > 169.254.144.149.80: Flags [S], seq 1939890441, win 65535, options [mss 1460,nop,wscale 8,nop,nop,sackOK], length 0

[2025-05-17 20:51:06,446] INFO in utils: tcpdump stderr: reading from file /home/taoli/NIDS_ByTaoLi/backend/uploads/cd40542d-8c8a-4348-894d-240393321f6d_APTbadnews.pcapng, link-type EN10MB (Ethernet), snapshot length 262144

[2025-05-17 20:51:06,446] INFO in utils: tcpdump stderr: reading from file /home/taoli/NIDS_ByTaoLi/backend/uploads/cd40542d-8c8a-4348-894d-240393321f6d_APTbadnews.pcapng, link-type EN10MB (Ethernet), snapshot length 262144

[2025-05-17 20:51:06,446] INFO in utils: 执行命令: /usr/bin/suricata --pcap-file-continuous --pcap-file-delete -r /home/taoli/NIDS_ByTaoLi/backend/uploads/cd40542d-8c8a-4348-894d-240393321f6d_APTbadnews.pcapng -v
[2025-05-17 20:51:06,446] INFO in utils: 执行命令: /usr/bin/suricata --pcap-file-continuous --pcap-file-delete -r /home/taoli/NIDS_ByTaoLi/backend/uploads/cd40542d-8c8a-4348-894d-240393321f6d_APTbadnews.pcapng -v
[2025-05-17 20:51:06,524] INFO in utils: suricata stdout: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed, 0
Info: threshold-config: Threshold config parsed: 0 rule(s) found
Info: detect: 7 signatures processed. 0 are IP-only rules, 3 are inspecting packet payload, 1 inspect application layer, 0 are decoder event only
Info: pcap: Starting file run for /home/taoli/NIDS_ByTaoLi/backend/uploads/cd40542d-8c8a-4348-894d-240393321f6d_APTbadnews.pcapng
Info: pcap: pcap file /home/taoli/NIDS_ByTaoLi/backend/uploads/cd40542d-8c8a-4348-894d-240393321f6d_APTbadnews.pcapng end of file reached (pcap err code 0)
Notice: threads: Threads created -> RX: 1 W: 2 FM: 1 FR: 1   Engine started.
Notice: suricata: Signal Received.  Stopping engine.
Info: suricata: time elapsed 0.020s
Notice: pcap: read 1 file, 153 packets, 47439 bytes

[2025-05-17 20:51:06,524] INFO in utils: suricata stdout: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed, 0
Info: threshold-config: Threshold config parsed: 0 rule(s) found
Info: detect: 7 signatures processed. 0 are IP-only rules, 3 are inspecting packet payload, 1 inspect application layer, 0 are decoder event only
Info: pcap: Starting file run for /home/taoli/NIDS_ByTaoLi/backend/uploads/cd40542d-8c8a-4348-894d-240393321f6d_APTbadnews.pcapng
Info: pcap: pcap file /home/taoli/NIDS_ByTaoLi/backend/uploads/cd40542d-8c8a-4348-894d-240393321f6d_APTbadnews.pcapng end of file reached (pcap err code 0)
Notice: threads: Threads created -> RX: 1 W: 2 FM: 1 FR: 1   Engine started.
Notice: suricata: Signal Received.  Stopping engine.
Info: suricata: time elapsed 0.020s
Notice: pcap: read 1 file, 153 packets, 47439 bytes

[2025-05-17 20:51:06,524] INFO in routes: 执行Suricata命令: /usr/bin/suricata -c /etc/suricata/suricata.yaml -r /home/taoli/NIDS_ByTaoLi/backend/uploads/cd40542d-8c8a-4348-894d-240393321f6d_APTbadnews.pcapng --set outputs.eve-log.filename=/home/taoli/NIDS_ByTaoLi/backend/uploads/cd40542d-8c8a-4348-894d-240393321f6d_eve.json
[2025-05-17 20:51:06,530] ERROR in routes: Suricata分析失败 (返回码 1): Error: suricata: pcap file '/home/taoli/NIDS_ByTaoLi/backend/uploads/cd40542d-8c8a-4348-894d-240393321f6d_APTbadnews.pcapng': No such file or directory

[2025-05-17 20:51:06,530] ERROR in routes: Suricata找不到文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/cd40542d-8c8a-4348-894d-240393321f6d_APTbadnews.pcapng
[2025-05-17 20:51:06,531] INFO in routes: 文件存在检查: False
[2025-05-17 20:51:06,531] ERROR in routes: Suricata分析失败: Suricata分析失败: Error: suricata: pcap file '/home/taoli/NIDS_ByTaoLi/backend/uploads/cd40542d-8c8a-4348-894d-240393321f6d_APTbadnews.pcapng': No such file or directory

[2025-05-17 20:51:19,707] INFO in routes: 上传目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 20:51:19,708] INFO in routes: 保存PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/3359aea0-b470-46a5-8b62-84cf37350bf4_Metasploit_Payload.pcap
[2025-05-17 20:51:19,709] INFO in routes: PCAP文件已保存: /home/taoli/NIDS_ByTaoLi/backend/uploads/3359aea0-b470-46a5-8b62-84cf37350bf4_Metasploit_Payload.pcap, 大小: 537631 字节
[2025-05-17 20:51:19,710] INFO in routes: 开始分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/3359aea0-b470-46a5-8b62-84cf37350bf4_Metasploit_Payload.pcap, 输出目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 20:51:19,711] INFO in routes: 已创建PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/3359aea0-b470-46a5-8b62-84cf37350bf4_Metasploit_Payload.pcap.bak
[2025-05-17 20:51:19,711] INFO in routes: 使用Suricata分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/3359aea0-b470-46a5-8b62-84cf37350bf4_Metasploit_Payload.pcap
[2025-05-17 20:51:19,712] INFO in routes: PCAP文件大小: 537631 字节
[2025-05-17 20:51:19,712] INFO in utils: 检查PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/3359aea0-b470-46a5-8b62-84cf37350bf4_Metasploit_Payload.pcap
[2025-05-17 20:51:19,712] INFO in utils: 检查PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/3359aea0-b470-46a5-8b62-84cf37350bf4_Metasploit_Payload.pcap
[2025-05-17 20:51:19,712] INFO in utils: PCAP文件大小: 537631 字节
[2025-05-17 20:51:19,712] INFO in utils: PCAP文件大小: 537631 字节
[2025-05-17 20:51:19,712] INFO in utils: 执行命令: tcpdump -r /home/taoli/NIDS_ByTaoLi/backend/uploads/3359aea0-b470-46a5-8b62-84cf37350bf4_Metasploit_Payload.pcap -c 1 -nn
[2025-05-17 20:51:19,712] INFO in utils: 执行命令: tcpdump -r /home/taoli/NIDS_ByTaoLi/backend/uploads/3359aea0-b470-46a5-8b62-84cf37350bf4_Metasploit_Payload.pcap -c 1 -nn
[2025-05-17 20:51:19,717] INFO in utils: tcpdump stdout: 15:11:21.876403 IP 192.168.160.134.5353 > 224.0.0.251.5353: 0 PTR (QM)? _googlecast._tcp.local. (40)

[2025-05-17 20:51:19,717] INFO in utils: tcpdump stdout: 15:11:21.876403 IP 192.168.160.134.5353 > 224.0.0.251.5353: 0 PTR (QM)? _googlecast._tcp.local. (40)

[2025-05-17 20:51:19,718] INFO in utils: tcpdump stderr: reading from file /home/taoli/NIDS_ByTaoLi/backend/uploads/3359aea0-b470-46a5-8b62-84cf37350bf4_Metasploit_Payload.pcap, link-type EN10MB (Ethernet), snapshot length 262144

[2025-05-17 20:51:19,718] INFO in utils: tcpdump stderr: reading from file /home/taoli/NIDS_ByTaoLi/backend/uploads/3359aea0-b470-46a5-8b62-84cf37350bf4_Metasploit_Payload.pcap, link-type EN10MB (Ethernet), snapshot length 262144

[2025-05-17 20:51:19,718] INFO in utils: 执行命令: /usr/bin/suricata --pcap-file-continuous --pcap-file-delete -r /home/taoli/NIDS_ByTaoLi/backend/uploads/3359aea0-b470-46a5-8b62-84cf37350bf4_Metasploit_Payload.pcap -v
[2025-05-17 20:51:19,718] INFO in utils: 执行命令: /usr/bin/suricata --pcap-file-continuous --pcap-file-delete -r /home/taoli/NIDS_ByTaoLi/backend/uploads/3359aea0-b470-46a5-8b62-84cf37350bf4_Metasploit_Payload.pcap -v
[2025-05-17 20:51:19,803] INFO in utils: suricata stdout: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed, 0
Info: threshold-config: Threshold config parsed: 0 rule(s) found
Info: detect: 7 signatures processed. 0 are IP-only rules, 3 are inspecting packet payload, 1 inspect application layer, 0 are decoder event only
Info: pcap: Starting file run for /home/taoli/NIDS_ByTaoLi/backend/uploads/3359aea0-b470-46a5-8b62-84cf37350bf4_Metasploit_Payload.pcap
Notice: threads: Threads created -> RX: 1 W: 2 FM: 1 FR: 1   Engine started.
Info: pcap: pcap file /home/taoli/NIDS_ByTaoLi/backend/uploads/3359aea0-b470-46a5-8b62-84cf37350bf4_Metasploit_Payload.pcap end of file reached (pcap err code 0)
Notice: suricata: Signal Received.  Stopping engine.
Info: suricata: time elapsed 0.027s
Warning: pcap: 1/7th of packets have an invalid checksum, consider setting pcap-file.checksum-checks variable to no or use '-k none' option on command line.
Notice: pcap: read 1 file, 749 packets, 525623 bytes

[2025-05-17 20:51:19,803] INFO in utils: suricata stdout: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed, 0
Info: threshold-config: Threshold config parsed: 0 rule(s) found
Info: detect: 7 signatures processed. 0 are IP-only rules, 3 are inspecting packet payload, 1 inspect application layer, 0 are decoder event only
Info: pcap: Starting file run for /home/taoli/NIDS_ByTaoLi/backend/uploads/3359aea0-b470-46a5-8b62-84cf37350bf4_Metasploit_Payload.pcap
Notice: threads: Threads created -> RX: 1 W: 2 FM: 1 FR: 1   Engine started.
Info: pcap: pcap file /home/taoli/NIDS_ByTaoLi/backend/uploads/3359aea0-b470-46a5-8b62-84cf37350bf4_Metasploit_Payload.pcap end of file reached (pcap err code 0)
Notice: suricata: Signal Received.  Stopping engine.
Info: suricata: time elapsed 0.027s
Warning: pcap: 1/7th of packets have an invalid checksum, consider setting pcap-file.checksum-checks variable to no or use '-k none' option on command line.
Notice: pcap: read 1 file, 749 packets, 525623 bytes

[2025-05-17 20:51:19,804] INFO in routes: 执行Suricata命令: /usr/bin/suricata -c /etc/suricata/suricata.yaml -r /home/taoli/NIDS_ByTaoLi/backend/uploads/3359aea0-b470-46a5-8b62-84cf37350bf4_Metasploit_Payload.pcap --set outputs.eve-log.filename=/home/taoli/NIDS_ByTaoLi/backend/uploads/3359aea0-b470-46a5-8b62-84cf37350bf4_eve.json
[2025-05-17 20:51:19,809] ERROR in routes: Suricata分析失败 (返回码 1): Error: suricata: pcap file '/home/taoli/NIDS_ByTaoLi/backend/uploads/3359aea0-b470-46a5-8b62-84cf37350bf4_Metasploit_Payload.pcap': No such file or directory

[2025-05-17 20:51:19,810] ERROR in routes: Suricata找不到文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/3359aea0-b470-46a5-8b62-84cf37350bf4_Metasploit_Payload.pcap
[2025-05-17 20:51:19,810] INFO in routes: 文件存在检查: False
[2025-05-17 20:51:19,810] ERROR in routes: Suricata分析失败: Suricata分析失败: Error: suricata: pcap file '/home/taoli/NIDS_ByTaoLi/backend/uploads/3359aea0-b470-46a5-8b62-84cf37350bf4_Metasploit_Payload.pcap': No such file or directory

[2025-05-17 20:53:39,795] INFO in __init__: 应用已启动
[2025-05-17 20:54:05,161] INFO in __init__: 应用已启动
[2025-05-17 20:54:18,473] INFO in __init__: 应用已启动
[2025-05-17 20:54:35,971] INFO in __init__: 应用已启动
[2025-05-17 20:54:36,279] INFO in __init__: 应用已启动
[2025-05-17 20:55:22,224] INFO in routes: 上传目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 20:55:22,224] INFO in routes: 保存PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/644dd4a7-b1ca-4171-8907-71d16d38f10e_Metasploit_Payload.pcap
[2025-05-17 20:55:22,225] INFO in routes: PCAP文件已保存: /home/taoli/NIDS_ByTaoLi/backend/uploads/644dd4a7-b1ca-4171-8907-71d16d38f10e_Metasploit_Payload.pcap, 大小: 537631 字节
[2025-05-17 20:55:22,226] INFO in routes: 开始分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/644dd4a7-b1ca-4171-8907-71d16d38f10e_Metasploit_Payload.pcap, 输出目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 20:55:22,227] INFO in routes: 已创建PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/644dd4a7-b1ca-4171-8907-71d16d38f10e_Metasploit_Payload.pcap.bak
[2025-05-17 20:55:22,227] INFO in routes: 使用Suricata分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/644dd4a7-b1ca-4171-8907-71d16d38f10e_Metasploit_Payload.pcap
[2025-05-17 20:55:22,227] INFO in routes: PCAP文件大小: 537631 字节
[2025-05-17 20:55:22,228] INFO in utils: 检查PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/644dd4a7-b1ca-4171-8907-71d16d38f10e_Metasploit_Payload.pcap
[2025-05-17 20:55:22,228] INFO in utils: 检查PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/644dd4a7-b1ca-4171-8907-71d16d38f10e_Metasploit_Payload.pcap
[2025-05-17 20:55:22,228] INFO in utils: PCAP文件大小: 537631 字节
[2025-05-17 20:55:22,228] INFO in utils: PCAP文件大小: 537631 字节
[2025-05-17 20:55:22,228] INFO in utils: 执行命令: tcpdump -r /home/taoli/NIDS_ByTaoLi/backend/uploads/644dd4a7-b1ca-4171-8907-71d16d38f10e_Metasploit_Payload.pcap -c 1 -nn
[2025-05-17 20:55:22,228] INFO in utils: 执行命令: tcpdump -r /home/taoli/NIDS_ByTaoLi/backend/uploads/644dd4a7-b1ca-4171-8907-71d16d38f10e_Metasploit_Payload.pcap -c 1 -nn
[2025-05-17 20:55:22,232] INFO in utils: tcpdump stdout: 15:11:21.876403 IP 192.168.160.134.5353 > 224.0.0.251.5353: 0 PTR (QM)? _googlecast._tcp.local. (40)

[2025-05-17 20:55:22,232] INFO in utils: tcpdump stdout: 15:11:21.876403 IP 192.168.160.134.5353 > 224.0.0.251.5353: 0 PTR (QM)? _googlecast._tcp.local. (40)

[2025-05-17 20:55:22,232] INFO in utils: tcpdump stderr: reading from file /home/taoli/NIDS_ByTaoLi/backend/uploads/644dd4a7-b1ca-4171-8907-71d16d38f10e_Metasploit_Payload.pcap, link-type EN10MB (Ethernet), snapshot length 262144

[2025-05-17 20:55:22,232] INFO in utils: tcpdump stderr: reading from file /home/taoli/NIDS_ByTaoLi/backend/uploads/644dd4a7-b1ca-4171-8907-71d16d38f10e_Metasploit_Payload.pcap, link-type EN10MB (Ethernet), snapshot length 262144

[2025-05-17 20:55:22,232] INFO in utils: 执行命令: /usr/bin/suricata --pcap-file-continuous -r /home/taoli/NIDS_ByTaoLi/backend/uploads/644dd4a7-b1ca-4171-8907-71d16d38f10e_Metasploit_Payload.pcap -v
[2025-05-17 20:55:22,232] INFO in utils: 执行命令: /usr/bin/suricata --pcap-file-continuous -r /home/taoli/NIDS_ByTaoLi/backend/uploads/644dd4a7-b1ca-4171-8907-71d16d38f10e_Metasploit_Payload.pcap -v
[2025-05-17 20:55:22,323] INFO in utils: suricata stdout: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed, 0
Info: threshold-config: Threshold config parsed: 0 rule(s) found
Info: detect: 7 signatures processed. 0 are IP-only rules, 3 are inspecting packet payload, 1 inspect application layer, 0 are decoder event only
Info: pcap: Starting file run for /home/taoli/NIDS_ByTaoLi/backend/uploads/644dd4a7-b1ca-4171-8907-71d16d38f10e_Metasploit_Payload.pcap
Notice: threads: Threads created -> RX: 1 W: 2 FM: 1 FR: 1   Engine started.
Info: pcap: pcap file /home/taoli/NIDS_ByTaoLi/backend/uploads/644dd4a7-b1ca-4171-8907-71d16d38f10e_Metasploit_Payload.pcap end of file reached (pcap err code 0)
Notice: suricata: Signal Received.  Stopping engine.
Info: suricata: time elapsed 0.026s
Warning: pcap: 1/7th of packets have an invalid checksum, consider setting pcap-file.checksum-checks variable to no or use '-k none' option on command line.
Notice: pcap: read 1 file, 749 packets, 525623 bytes

[2025-05-17 20:55:22,323] INFO in utils: suricata stdout: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed, 0
Info: threshold-config: Threshold config parsed: 0 rule(s) found
Info: detect: 7 signatures processed. 0 are IP-only rules, 3 are inspecting packet payload, 1 inspect application layer, 0 are decoder event only
Info: pcap: Starting file run for /home/taoli/NIDS_ByTaoLi/backend/uploads/644dd4a7-b1ca-4171-8907-71d16d38f10e_Metasploit_Payload.pcap
Notice: threads: Threads created -> RX: 1 W: 2 FM: 1 FR: 1   Engine started.
Info: pcap: pcap file /home/taoli/NIDS_ByTaoLi/backend/uploads/644dd4a7-b1ca-4171-8907-71d16d38f10e_Metasploit_Payload.pcap end of file reached (pcap err code 0)
Notice: suricata: Signal Received.  Stopping engine.
Info: suricata: time elapsed 0.026s
Warning: pcap: 1/7th of packets have an invalid checksum, consider setting pcap-file.checksum-checks variable to no or use '-k none' option on command line.
Notice: pcap: read 1 file, 749 packets, 525623 bytes

[2025-05-17 20:55:22,324] INFO in routes: 执行Suricata命令: /usr/bin/suricata -c /etc/suricata/suricata.yaml -r /home/taoli/NIDS_ByTaoLi/backend/uploads/644dd4a7-b1ca-4171-8907-71d16d38f10e_Metasploit_Payload.pcap --set outputs.eve-log.filename=/home/taoli/NIDS_ByTaoLi/backend/uploads/644dd4a7-b1ca-4171-8907-71d16d38f10e_eve.json
[2025-05-17 20:55:23,459] INFO in routes: Suricata输出: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'

[2025-05-17 20:55:23,460] ERROR in routes: Suricata分析失败 (返回码 -11): 
[2025-05-17 20:55:23,460] ERROR in routes: Suricata分析失败: Suricata分析失败: 
[2025-05-17 20:56:17,111] INFO in __init__: 应用已启动
[2025-05-17 20:57:04,683] INFO in __init__: 应用已启动
[2025-05-17 20:57:35,013] INFO in __init__: 应用已启动
[2025-05-17 20:57:35,392] INFO in __init__: 应用已启动
[2025-05-17 20:57:50,605] INFO in routes: 上传目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 20:57:50,606] INFO in routes: 保存PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/accee039-1896-4c7f-957a-0f8f3c66029d_Metasploit_Payload.pcap
[2025-05-17 20:57:50,607] INFO in routes: PCAP文件已保存: /home/taoli/NIDS_ByTaoLi/backend/uploads/accee039-1896-4c7f-957a-0f8f3c66029d_Metasploit_Payload.pcap, 大小: 537631 字节
[2025-05-17 20:57:50,609] INFO in routes: 开始分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/accee039-1896-4c7f-957a-0f8f3c66029d_Metasploit_Payload.pcap, 输出目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 20:57:50,610] INFO in routes: 已创建PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/accee039-1896-4c7f-957a-0f8f3c66029d_Metasploit_Payload.pcap.bak
[2025-05-17 20:57:50,610] INFO in routes: 使用Suricata分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/accee039-1896-4c7f-957a-0f8f3c66029d_Metasploit_Payload.pcap
[2025-05-17 20:57:50,610] INFO in routes: PCAP文件大小: 537631 字节
[2025-05-17 20:57:50,610] INFO in utils: 检查PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/accee039-1896-4c7f-957a-0f8f3c66029d_Metasploit_Payload.pcap
[2025-05-17 20:57:50,610] INFO in utils: 检查PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/accee039-1896-4c7f-957a-0f8f3c66029d_Metasploit_Payload.pcap
[2025-05-17 20:57:50,610] INFO in utils: PCAP文件大小: 537631 字节
[2025-05-17 20:57:50,610] INFO in utils: PCAP文件大小: 537631 字节
[2025-05-17 20:57:50,610] INFO in utils: 执行命令: tcpdump -r /home/taoli/NIDS_ByTaoLi/backend/uploads/accee039-1896-4c7f-957a-0f8f3c66029d_Metasploit_Payload.pcap -c 1 -nn
[2025-05-17 20:57:50,610] INFO in utils: 执行命令: tcpdump -r /home/taoli/NIDS_ByTaoLi/backend/uploads/accee039-1896-4c7f-957a-0f8f3c66029d_Metasploit_Payload.pcap -c 1 -nn
[2025-05-17 20:57:50,614] INFO in utils: tcpdump stdout: 15:11:21.876403 IP 192.168.160.134.5353 > 224.0.0.251.5353: 0 PTR (QM)? _googlecast._tcp.local. (40)

[2025-05-17 20:57:50,614] INFO in utils: tcpdump stdout: 15:11:21.876403 IP 192.168.160.134.5353 > 224.0.0.251.5353: 0 PTR (QM)? _googlecast._tcp.local. (40)

[2025-05-17 20:57:50,614] INFO in utils: tcpdump stderr: reading from file /home/taoli/NIDS_ByTaoLi/backend/uploads/accee039-1896-4c7f-957a-0f8f3c66029d_Metasploit_Payload.pcap, link-type EN10MB (Ethernet), snapshot length 262144

[2025-05-17 20:57:50,614] INFO in utils: tcpdump stderr: reading from file /home/taoli/NIDS_ByTaoLi/backend/uploads/accee039-1896-4c7f-957a-0f8f3c66029d_Metasploit_Payload.pcap, link-type EN10MB (Ethernet), snapshot length 262144

[2025-05-17 20:57:50,614] INFO in utils: 执行命令: /usr/bin/suricata --pcap-file-continuous -r /home/taoli/NIDS_ByTaoLi/backend/uploads/accee039-1896-4c7f-957a-0f8f3c66029d_Metasploit_Payload.pcap -v
[2025-05-17 20:57:50,614] INFO in utils: 执行命令: /usr/bin/suricata --pcap-file-continuous -r /home/taoli/NIDS_ByTaoLi/backend/uploads/accee039-1896-4c7f-957a-0f8f3c66029d_Metasploit_Payload.pcap -v
[2025-05-17 20:57:50,695] INFO in utils: suricata stdout: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed, 0
Info: threshold-config: Threshold config parsed: 0 rule(s) found
Info: detect: 7 signatures processed. 0 are IP-only rules, 3 are inspecting packet payload, 1 inspect application layer, 0 are decoder event only
Info: pcap: Starting file run for /home/taoli/NIDS_ByTaoLi/backend/uploads/accee039-1896-4c7f-957a-0f8f3c66029d_Metasploit_Payload.pcap
Info: pcap: pcap file /home/taoli/NIDS_ByTaoLi/backend/uploads/accee039-1896-4c7f-957a-0f8f3c66029d_Metasploit_Payload.pcap end of file reached (pcap err code 0)
Notice: threads: Threads created -> RX: 1 W: 2 FM: 1 FR: 1   Engine started.
Notice: suricata: Signal Received.  Stopping engine.
Info: suricata: time elapsed 0.019s
Warning: pcap: 1/7th of packets have an invalid checksum, consider setting pcap-file.checksum-checks variable to no or use '-k none' option on command line.
Notice: pcap: read 1 file, 749 packets, 525623 bytes

[2025-05-17 20:57:50,695] INFO in utils: suricata stdout: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed, 0
Info: threshold-config: Threshold config parsed: 0 rule(s) found
Info: detect: 7 signatures processed. 0 are IP-only rules, 3 are inspecting packet payload, 1 inspect application layer, 0 are decoder event only
Info: pcap: Starting file run for /home/taoli/NIDS_ByTaoLi/backend/uploads/accee039-1896-4c7f-957a-0f8f3c66029d_Metasploit_Payload.pcap
Info: pcap: pcap file /home/taoli/NIDS_ByTaoLi/backend/uploads/accee039-1896-4c7f-957a-0f8f3c66029d_Metasploit_Payload.pcap end of file reached (pcap err code 0)
Notice: threads: Threads created -> RX: 1 W: 2 FM: 1 FR: 1   Engine started.
Notice: suricata: Signal Received.  Stopping engine.
Info: suricata: time elapsed 0.019s
Warning: pcap: 1/7th of packets have an invalid checksum, consider setting pcap-file.checksum-checks variable to no or use '-k none' option on command line.
Notice: pcap: read 1 file, 749 packets, 525623 bytes

[2025-05-17 20:57:50,696] INFO in routes: 执行Suricata命令(default模式): /usr/bin/suricata -c /etc/suricata/suricata.yaml -r /home/taoli/NIDS_ByTaoLi/backend/uploads/accee039-1896-4c7f-957a-0f8f3c66029d_Metasploit_Payload.pcap --set outputs.eve-log.filename=/home/taoli/NIDS_ByTaoLi/backend/uploads/accee039-1896-4c7f-957a-0f8f3c66029d_eve.json
[2025-05-17 20:57:51,828] INFO in routes: Suricata输出: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'

[2025-05-17 20:57:51,828] ERROR in routes: Suricata分析失败 (返回码 -11): 
[2025-05-17 20:57:51,828] ERROR in routes: Suricata可能遇到了段错误或内存访问问题
[2025-05-17 20:57:51,829] WARNING in routes: 默认模式分析失败: Suricata处理此PCAP文件时崩溃，可能包含特殊的数据包结构，尝试安全模式...
[2025-05-17 20:57:51,829] INFO in routes: 执行Suricata命令(safe模式): /usr/bin/suricata -c /etc/suricata/suricata.yaml --runmode=single --set detect.profile=low --set detect.sgh-mpm-context=auto --set threading.set-cpu-affinity=no -r /home/taoli/NIDS_ByTaoLi/backend/uploads/accee039-1896-4c7f-957a-0f8f3c66029d_Metasploit_Payload.pcap --set outputs.eve-log.filename=/home/taoli/NIDS_ByTaoLi/backend/uploads/accee039-1896-4c7f-957a-0f8f3c66029d_eve.json
[2025-05-17 20:57:52,952] INFO in routes: Suricata输出: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'

[2025-05-17 20:57:52,953] ERROR in routes: Suricata分析失败 (返回码 -11): 
[2025-05-17 20:57:52,953] ERROR in routes: Suricata可能遇到了段错误或内存访问问题
[2025-05-17 20:57:52,953] WARNING in routes: 安全模式分析失败: Suricata处理此PCAP文件时崩溃，可能包含特殊的数据包结构，尝试最小规则集模式...
[2025-05-17 20:57:52,953] INFO in routes: 执行Suricata命令(minimal模式): /usr/bin/suricata --disable-detection -c /etc/suricata/suricata.yaml -r /home/taoli/NIDS_ByTaoLi/backend/uploads/accee039-1896-4c7f-957a-0f8f3c66029d_Metasploit_Payload.pcap --set outputs.eve-log.filename=/home/taoli/NIDS_ByTaoLi/backend/uploads/accee039-1896-4c7f-957a-0f8f3c66029d_eve.json
[2025-05-17 20:57:54,088] INFO in routes: Suricata输出: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'

[2025-05-17 20:57:54,088] ERROR in routes: Suricata分析失败 (返回码 -11): 
[2025-05-17 20:57:54,088] ERROR in routes: Suricata可能遇到了段错误或内存访问问题
[2025-05-17 20:57:54,088] ERROR in routes: Suricata分析失败: Suricata分析失败: Suricata处理此PCAP文件时崩溃，可能包含特殊的数据包结构
[2025-05-17 21:00:04,583] INFO in routes: 上传目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 21:00:04,584] INFO in routes: 保存PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/e150ba67-12b8-4b76-9aec-f71ba5ce366c_1.pcap
[2025-05-17 21:00:04,585] INFO in routes: PCAP文件已保存: /home/taoli/NIDS_ByTaoLi/backend/uploads/e150ba67-12b8-4b76-9aec-f71ba5ce366c_1.pcap, 大小: 300355 字节
[2025-05-17 21:00:04,586] INFO in routes: 开始分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/e150ba67-12b8-4b76-9aec-f71ba5ce366c_1.pcap, 输出目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 21:00:04,587] INFO in routes: 已创建PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/e150ba67-12b8-4b76-9aec-f71ba5ce366c_1.pcap.bak
[2025-05-17 21:00:04,587] INFO in routes: 使用Suricata分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/e150ba67-12b8-4b76-9aec-f71ba5ce366c_1.pcap
[2025-05-17 21:00:04,587] INFO in routes: PCAP文件大小: 300355 字节
[2025-05-17 21:00:04,587] INFO in utils: 检查PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/e150ba67-12b8-4b76-9aec-f71ba5ce366c_1.pcap
[2025-05-17 21:00:04,587] INFO in utils: 检查PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/e150ba67-12b8-4b76-9aec-f71ba5ce366c_1.pcap
[2025-05-17 21:00:04,587] INFO in utils: PCAP文件大小: 300355 字节
[2025-05-17 21:00:04,587] INFO in utils: PCAP文件大小: 300355 字节
[2025-05-17 21:00:04,587] INFO in utils: 执行命令: tcpdump -r /home/taoli/NIDS_ByTaoLi/backend/uploads/e150ba67-12b8-4b76-9aec-f71ba5ce366c_1.pcap -c 1 -nn
[2025-05-17 21:00:04,587] INFO in utils: 执行命令: tcpdump -r /home/taoli/NIDS_ByTaoLi/backend/uploads/e150ba67-12b8-4b76-9aec-f71ba5ce366c_1.pcap -c 1 -nn
[2025-05-17 21:00:04,591] INFO in utils: tcpdump stdout: 20:58:39.791059 IP6 2400:3200:baba::1.443 > 2408:820c:5b28:1770:5405:23a7:16e0:78c6.41545: Flags [P.], seq 25689205:25689244, ack 2093835586, win 21, length 39

[2025-05-17 21:00:04,591] INFO in utils: tcpdump stdout: 20:58:39.791059 IP6 2400:3200:baba::1.443 > 2408:820c:5b28:1770:5405:23a7:16e0:78c6.41545: Flags [P.], seq 25689205:25689244, ack 2093835586, win 21, length 39

[2025-05-17 21:00:04,591] INFO in utils: tcpdump stderr: reading from file /home/taoli/NIDS_ByTaoLi/backend/uploads/e150ba67-12b8-4b76-9aec-f71ba5ce366c_1.pcap, link-type EN10MB (Ethernet), snapshot length 262144

[2025-05-17 21:00:04,591] INFO in utils: tcpdump stderr: reading from file /home/taoli/NIDS_ByTaoLi/backend/uploads/e150ba67-12b8-4b76-9aec-f71ba5ce366c_1.pcap, link-type EN10MB (Ethernet), snapshot length 262144

[2025-05-17 21:00:04,591] INFO in utils: 执行命令: /usr/bin/suricata --pcap-file-continuous -r /home/taoli/NIDS_ByTaoLi/backend/uploads/e150ba67-12b8-4b76-9aec-f71ba5ce366c_1.pcap -v
[2025-05-17 21:00:04,591] INFO in utils: 执行命令: /usr/bin/suricata --pcap-file-continuous -r /home/taoli/NIDS_ByTaoLi/backend/uploads/e150ba67-12b8-4b76-9aec-f71ba5ce366c_1.pcap -v
[2025-05-17 21:00:04,675] INFO in utils: suricata stdout: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed, 0
Info: threshold-config: Threshold config parsed: 0 rule(s) found
Info: detect: 7 signatures processed. 0 are IP-only rules, 3 are inspecting packet payload, 1 inspect application layer, 0 are decoder event only
Info: pcap: Starting file run for /home/taoli/NIDS_ByTaoLi/backend/uploads/e150ba67-12b8-4b76-9aec-f71ba5ce366c_1.pcap
Info: checksum: No packets with invalid checksum, assuming checksum offloading is NOT used
Notice: threads: Threads created -> RX: 1 W: 2 FM: 1 FR: 1   Engine started.
Info: pcap: pcap file /home/taoli/NIDS_ByTaoLi/backend/uploads/e150ba67-12b8-4b76-9aec-f71ba5ce366c_1.pcap end of file reached (pcap err code 0)
Notice: suricata: Signal Received.  Stopping engine.
Info: suricata: time elapsed 0.027s
Notice: pcap: read 1 file, 1954 packets, 269067 bytes

[2025-05-17 21:00:04,675] INFO in utils: suricata stdout: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed, 0
Info: threshold-config: Threshold config parsed: 0 rule(s) found
Info: detect: 7 signatures processed. 0 are IP-only rules, 3 are inspecting packet payload, 1 inspect application layer, 0 are decoder event only
Info: pcap: Starting file run for /home/taoli/NIDS_ByTaoLi/backend/uploads/e150ba67-12b8-4b76-9aec-f71ba5ce366c_1.pcap
Info: checksum: No packets with invalid checksum, assuming checksum offloading is NOT used
Notice: threads: Threads created -> RX: 1 W: 2 FM: 1 FR: 1   Engine started.
Info: pcap: pcap file /home/taoli/NIDS_ByTaoLi/backend/uploads/e150ba67-12b8-4b76-9aec-f71ba5ce366c_1.pcap end of file reached (pcap err code 0)
Notice: suricata: Signal Received.  Stopping engine.
Info: suricata: time elapsed 0.027s
Notice: pcap: read 1 file, 1954 packets, 269067 bytes

[2025-05-17 21:00:04,676] INFO in routes: 执行Suricata命令(default模式): /usr/bin/suricata -c /etc/suricata/suricata.yaml -r /home/taoli/NIDS_ByTaoLi/backend/uploads/e150ba67-12b8-4b76-9aec-f71ba5ce366c_1.pcap --set outputs.eve-log.filename=/home/taoli/NIDS_ByTaoLi/backend/uploads/e150ba67-12b8-4b76-9aec-f71ba5ce366c_eve.json
[2025-05-17 21:00:05,803] INFO in routes: Suricata输出: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'

[2025-05-17 21:00:05,803] ERROR in routes: Suricata分析失败 (返回码 -11): 
[2025-05-17 21:00:05,803] ERROR in routes: Suricata可能遇到了段错误或内存访问问题
[2025-05-17 21:00:05,803] WARNING in routes: 默认模式分析失败: Suricata处理此PCAP文件时崩溃，可能包含特殊的数据包结构，尝试安全模式...
[2025-05-17 21:00:05,803] INFO in routes: 执行Suricata命令(safe模式): /usr/bin/suricata -c /etc/suricata/suricata.yaml --runmode=single --set detect.profile=low --set detect.sgh-mpm-context=auto --set threading.set-cpu-affinity=no -r /home/taoli/NIDS_ByTaoLi/backend/uploads/e150ba67-12b8-4b76-9aec-f71ba5ce366c_1.pcap --set outputs.eve-log.filename=/home/taoli/NIDS_ByTaoLi/backend/uploads/e150ba67-12b8-4b76-9aec-f71ba5ce366c_eve.json
[2025-05-17 21:00:06,920] INFO in routes: Suricata输出: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'

[2025-05-17 21:00:06,920] ERROR in routes: Suricata分析失败 (返回码 -11): 
[2025-05-17 21:00:06,920] ERROR in routes: Suricata可能遇到了段错误或内存访问问题
[2025-05-17 21:00:06,921] WARNING in routes: 安全模式分析失败: Suricata处理此PCAP文件时崩溃，可能包含特殊的数据包结构，尝试最小规则集模式...
[2025-05-17 21:00:06,921] INFO in routes: 执行Suricata命令(minimal模式): /usr/bin/suricata --disable-detection -c /etc/suricata/suricata.yaml -r /home/taoli/NIDS_ByTaoLi/backend/uploads/e150ba67-12b8-4b76-9aec-f71ba5ce366c_1.pcap --set outputs.eve-log.filename=/home/taoli/NIDS_ByTaoLi/backend/uploads/e150ba67-12b8-4b76-9aec-f71ba5ce366c_eve.json
[2025-05-17 21:00:08,039] INFO in routes: Suricata输出: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'

[2025-05-17 21:00:08,040] ERROR in routes: Suricata分析失败 (返回码 -11): 
[2025-05-17 21:00:08,040] ERROR in routes: Suricata可能遇到了段错误或内存访问问题
[2025-05-17 21:00:08,040] ERROR in routes: Suricata分析失败: Suricata分析失败: Suricata处理此PCAP文件时崩溃，可能包含特殊的数据包结构
[2025-05-17 21:09:33,409] INFO in __init__: 应用已启动
[2025-05-17 21:09:49,760] INFO in __init__: 应用已启动
[2025-05-17 21:10:03,152] INFO in __init__: 应用已启动
[2025-05-17 21:10:17,472] INFO in __init__: 应用已启动
[2025-05-17 21:10:39,045] INFO in __init__: 应用已启动
[2025-05-17 21:10:39,397] INFO in __init__: 应用已启动
[2025-05-17 21:13:06,523] INFO in __init__: 应用已启动
[2025-05-17 21:13:19,980] INFO in __init__: 应用已启动
[2025-05-17 21:13:23,259] INFO in __init__: 应用已启动
[2025-05-17 21:13:47,728] INFO in __init__: 应用已启动
[2025-05-17 21:14:44,228] INFO in __init__: 应用已启动
[2025-05-17 21:14:44,813] INFO in __init__: 应用已启动
[2025-05-17 21:14:56,229] INFO in __init__: 应用已启动
[2025-05-17 21:15:01,866] INFO in routes: 上传目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 21:15:01,868] INFO in routes: 保存PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/d8272586-e0c6-400e-b89a-d91bd6131e46_1.pcap
[2025-05-17 21:15:01,868] INFO in routes: PCAP文件已保存: /home/taoli/NIDS_ByTaoLi/backend/uploads/d8272586-e0c6-400e-b89a-d91bd6131e46_1.pcap, 大小: 300355 字节
[2025-05-17 21:15:01,870] INFO in routes: 开始分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/d8272586-e0c6-400e-b89a-d91bd6131e46_1.pcap, 输出目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 21:15:01,870] INFO in routes: 已创建PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/d8272586-e0c6-400e-b89a-d91bd6131e46_1.pcap.bak
[2025-05-17 21:15:01,870] INFO in routes: 使用Suricata分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/d8272586-e0c6-400e-b89a-d91bd6131e46_1.pcap
[2025-05-17 21:15:01,870] INFO in routes: PCAP文件大小: 300355 字节
[2025-05-17 21:15:01,870] INFO in utils: 检查PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/d8272586-e0c6-400e-b89a-d91bd6131e46_1.pcap
[2025-05-17 21:15:01,870] INFO in utils: 检查PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/d8272586-e0c6-400e-b89a-d91bd6131e46_1.pcap
[2025-05-17 21:15:01,870] INFO in utils: PCAP文件大小: 300355 字节
[2025-05-17 21:15:01,870] INFO in utils: PCAP文件大小: 300355 字节
[2025-05-17 21:15:01,871] INFO in utils: 执行命令: tcpdump -r /home/taoli/NIDS_ByTaoLi/backend/uploads/d8272586-e0c6-400e-b89a-d91bd6131e46_1.pcap -c 1 -nn
[2025-05-17 21:15:01,871] INFO in utils: 执行命令: tcpdump -r /home/taoli/NIDS_ByTaoLi/backend/uploads/d8272586-e0c6-400e-b89a-d91bd6131e46_1.pcap -c 1 -nn
[2025-05-17 21:15:01,877] INFO in utils: tcpdump stdout: 20:58:39.791059 IP6 2400:3200:baba::1.443 > 2408:820c:5b28:1770:5405:23a7:16e0:78c6.41545: Flags [P.], seq 25689205:25689244, ack 2093835586, win 21, length 39

[2025-05-17 21:15:01,877] INFO in utils: tcpdump stdout: 20:58:39.791059 IP6 2400:3200:baba::1.443 > 2408:820c:5b28:1770:5405:23a7:16e0:78c6.41545: Flags [P.], seq 25689205:25689244, ack 2093835586, win 21, length 39

[2025-05-17 21:15:01,878] INFO in utils: tcpdump stderr: reading from file /home/taoli/NIDS_ByTaoLi/backend/uploads/d8272586-e0c6-400e-b89a-d91bd6131e46_1.pcap, link-type EN10MB (Ethernet), snapshot length 262144

[2025-05-17 21:15:01,878] INFO in utils: tcpdump stderr: reading from file /home/taoli/NIDS_ByTaoLi/backend/uploads/d8272586-e0c6-400e-b89a-d91bd6131e46_1.pcap, link-type EN10MB (Ethernet), snapshot length 262144

[2025-05-17 21:15:01,878] INFO in utils: 执行命令: /usr/bin/suricata --pcap-file-continuous -r /home/taoli/NIDS_ByTaoLi/backend/uploads/d8272586-e0c6-400e-b89a-d91bd6131e46_1.pcap -v
[2025-05-17 21:15:01,878] INFO in utils: 执行命令: /usr/bin/suricata --pcap-file-continuous -r /home/taoli/NIDS_ByTaoLi/backend/uploads/d8272586-e0c6-400e-b89a-d91bd6131e46_1.pcap -v
[2025-05-17 21:15:01,975] INFO in utils: suricata stdout: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed, 0
Info: threshold-config: Threshold config parsed: 0 rule(s) found
Info: detect: 7 signatures processed. 0 are IP-only rules, 3 are inspecting packet payload, 1 inspect application layer, 0 are decoder event only
Info: pcap: Starting file run for /home/taoli/NIDS_ByTaoLi/backend/uploads/d8272586-e0c6-400e-b89a-d91bd6131e46_1.pcap
Info: checksum: Less than 1/10th of packets have an invalid checksum, assuming checksum offloading is NOT used (66/1000)
Info: pcap: pcap file /home/taoli/NIDS_ByTaoLi/backend/uploads/d8272586-e0c6-400e-b89a-d91bd6131e46_1.pcap end of file reached (pcap err code 0)
Notice: threads: Threads created -> RX: 1 W: 2 FM: 1 FR: 1   Engine started.
Notice: suricata: Signal Received.  Stopping engine.
Info: suricata: time elapsed 0.025s
Notice: pcap: read 1 file, 1954 packets, 269067 bytes

[2025-05-17 21:15:01,975] INFO in utils: suricata stdout: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed, 0
Info: threshold-config: Threshold config parsed: 0 rule(s) found
Info: detect: 7 signatures processed. 0 are IP-only rules, 3 are inspecting packet payload, 1 inspect application layer, 0 are decoder event only
Info: pcap: Starting file run for /home/taoli/NIDS_ByTaoLi/backend/uploads/d8272586-e0c6-400e-b89a-d91bd6131e46_1.pcap
Info: checksum: Less than 1/10th of packets have an invalid checksum, assuming checksum offloading is NOT used (66/1000)
Info: pcap: pcap file /home/taoli/NIDS_ByTaoLi/backend/uploads/d8272586-e0c6-400e-b89a-d91bd6131e46_1.pcap end of file reached (pcap err code 0)
Notice: threads: Threads created -> RX: 1 W: 2 FM: 1 FR: 1   Engine started.
Notice: suricata: Signal Received.  Stopping engine.
Info: suricata: time elapsed 0.025s
Notice: pcap: read 1 file, 1954 packets, 269067 bytes

[2025-05-17 21:15:01,975] INFO in routes: 执行Suricata命令(default模式): /usr/bin/suricata -c /etc/suricata/suricata.yaml -r /home/taoli/NIDS_ByTaoLi/backend/uploads/d8272586-e0c6-400e-b89a-d91bd6131e46_1.pcap -v -k none --set outputs.eve-log.filename=/home/taoli/NIDS_ByTaoLi/backend/uploads/d8272586-e0c6-400e-b89a-d91bd6131e46_eve.json
[2025-05-17 21:15:03,142] INFO in routes: Suricata输出: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'

[2025-05-17 21:15:03,143] ERROR in routes: Suricata分析失败 (返回码 -11): 
[2025-05-17 21:15:03,143] ERROR in routes: Suricata可能遇到了段错误或内存访问问题，返回码: -11
[2025-05-17 21:15:03,148] INFO in routes: PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/d8272586-e0c6-400e-b89a-d91bd6131e46_1.pcap: pcap capture file, microsecond ts (little-endian) - version 2.4 (Ethernet, capture length 262144)

[2025-05-17 21:15:03,156] INFO in routes: tcpdump检查结果: reading from file /home/taoli/NIDS_ByTaoLi/backend/uploads/d8272586-e0c6-400e-b89a-d91bd6131e46_1.pcap, link-type EN10MB (Ethernet), snapshot length 262144

[2025-05-17 21:15:03,156] WARNING in routes: 默认模式分析失败: Suricata处理此PCAP文件时崩溃 (返回码: -11)，可能包含特殊的数据包结构，尝试安全模式...
[2025-05-17 21:15:03,157] INFO in routes: 执行Suricata命令(safe模式): /usr/bin/suricata -c /etc/suricata/suricata.yaml --runmode=single -k none -r /home/taoli/NIDS_ByTaoLi/backend/uploads/d8272586-e0c6-400e-b89a-d91bd6131e46_1.pcap -v --set outputs.eve-log.filename=/home/taoli/NIDS_ByTaoLi/backend/uploads/d8272586-e0c6-400e-b89a-d91bd6131e46_eve.json
[2025-05-17 21:15:04,329] INFO in routes: Suricata输出: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'

[2025-05-17 21:15:04,330] ERROR in routes: Suricata分析失败 (返回码 -11): 
[2025-05-17 21:15:04,330] ERROR in routes: Suricata可能遇到了段错误或内存访问问题，返回码: -11
[2025-05-17 21:15:04,335] INFO in routes: PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/d8272586-e0c6-400e-b89a-d91bd6131e46_1.pcap: pcap capture file, microsecond ts (little-endian) - version 2.4 (Ethernet, capture length 262144)

[2025-05-17 21:15:04,342] INFO in routes: tcpdump检查结果: reading from file /home/taoli/NIDS_ByTaoLi/backend/uploads/d8272586-e0c6-400e-b89a-d91bd6131e46_1.pcap, link-type EN10MB (Ethernet), snapshot length 262144

[2025-05-17 21:15:04,342] WARNING in routes: 安全模式分析失败: Suricata处理此PCAP文件时崩溃 (返回码: -11)，可能包含特殊的数据包结构，尝试最小规则集模式...
[2025-05-17 21:15:04,342] INFO in routes: 执行Suricata命令(minimal模式): /usr/bin/suricata --disable-detection -k none -c /etc/suricata/suricata.yaml -r /home/taoli/NIDS_ByTaoLi/backend/uploads/d8272586-e0c6-400e-b89a-d91bd6131e46_1.pcap -v --set outputs.eve-log.filename=/home/taoli/NIDS_ByTaoLi/backend/uploads/d8272586-e0c6-400e-b89a-d91bd6131e46_eve.json
[2025-05-17 21:15:05,535] INFO in routes: Suricata输出: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'

[2025-05-17 21:15:05,535] ERROR in routes: Suricata分析失败 (返回码 -11): 
[2025-05-17 21:15:05,535] ERROR in routes: Suricata可能遇到了段错误或内存访问问题，返回码: -11
[2025-05-17 21:15:05,545] INFO in routes: PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/d8272586-e0c6-400e-b89a-d91bd6131e46_1.pcap: pcap capture file, microsecond ts (little-endian) - version 2.4 (Ethernet, capture length 262144)

[2025-05-17 21:15:05,553] INFO in routes: tcpdump检查结果: reading from file /home/taoli/NIDS_ByTaoLi/backend/uploads/d8272586-e0c6-400e-b89a-d91bd6131e46_1.pcap, link-type EN10MB (Ethernet), snapshot length 262144

[2025-05-17 21:15:05,554] ERROR in routes: Suricata分析失败: Suricata分析失败: Suricata处理此PCAP文件时崩溃 (返回码: -11)，可能包含特殊的数据包结构
[2025-05-17 21:15:36,556] INFO in routes: 上传目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 21:15:36,557] INFO in routes: 保存PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap
[2025-05-17 21:15:36,558] INFO in routes: PCAP文件已保存: /home/taoli/NIDS_ByTaoLi/backend/uploads/ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap, 大小: 509929 字节
[2025-05-17 21:15:36,559] INFO in routes: 开始分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap, 输出目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 21:15:36,560] INFO in routes: 已创建PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap.bak
[2025-05-17 21:15:36,561] INFO in routes: 使用Suricata分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap
[2025-05-17 21:15:36,561] INFO in routes: PCAP文件大小: 509929 字节
[2025-05-17 21:15:36,561] INFO in utils: 检查PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap
[2025-05-17 21:15:36,561] INFO in utils: 检查PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap
[2025-05-17 21:15:36,561] INFO in utils: PCAP文件大小: 509929 字节
[2025-05-17 21:15:36,561] INFO in utils: PCAP文件大小: 509929 字节
[2025-05-17 21:15:36,561] INFO in utils: 执行命令: tcpdump -r /home/taoli/NIDS_ByTaoLi/backend/uploads/ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap -c 1 -nn
[2025-05-17 21:15:36,561] INFO in utils: 执行命令: tcpdump -r /home/taoli/NIDS_ByTaoLi/backend/uploads/ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap -c 1 -nn
[2025-05-17 21:15:36,565] INFO in utils: tcpdump stdout: 19:40:20.181733 Request-To-Send TA:50:bd:5f:7a:61:50 

[2025-05-17 21:15:36,565] INFO in utils: tcpdump stdout: 19:40:20.181733 Request-To-Send TA:50:bd:5f:7a:61:50 

[2025-05-17 21:15:36,565] INFO in utils: tcpdump stderr: reading from file /home/taoli/NIDS_ByTaoLi/backend/uploads/ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap, link-type IEEE802_11 (802.11), snapshot length 65535

[2025-05-17 21:15:36,565] INFO in utils: tcpdump stderr: reading from file /home/taoli/NIDS_ByTaoLi/backend/uploads/ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap, link-type IEEE802_11 (802.11), snapshot length 65535

[2025-05-17 21:15:36,565] INFO in utils: 执行命令: /usr/bin/suricata --pcap-file-continuous -r /home/taoli/NIDS_ByTaoLi/backend/uploads/ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap -v
[2025-05-17 21:15:36,565] INFO in utils: 执行命令: /usr/bin/suricata --pcap-file-continuous -r /home/taoli/NIDS_ByTaoLi/backend/uploads/ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap -v
[2025-05-17 21:15:36,641] INFO in utils: suricata stdout: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed, 0
Info: threshold-config: Threshold config parsed: 0 rule(s) found
Info: detect: 7 signatures processed. 0 are IP-only rules, 3 are inspecting packet payload, 1 inspect application layer, 0 are decoder event only
Warning: pcap: Failed to init pcap file /home/taoli/NIDS_ByTaoLi/backend/uploads/ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap, skipping
Notice: threads: Threads created -> RX: 1 W: 2 FM: 1 FR: 1   Engine started.
Notice: suricata: Signal Received.  Stopping engine.
Info: suricata: time elapsed 0.018s

[2025-05-17 21:15:36,641] INFO in utils: suricata stdout: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed, 0
Info: threshold-config: Threshold config parsed: 0 rule(s) found
Info: detect: 7 signatures processed. 0 are IP-only rules, 3 are inspecting packet payload, 1 inspect application layer, 0 are decoder event only
Warning: pcap: Failed to init pcap file /home/taoli/NIDS_ByTaoLi/backend/uploads/ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap, skipping
Notice: threads: Threads created -> RX: 1 W: 2 FM: 1 FR: 1   Engine started.
Notice: suricata: Signal Received.  Stopping engine.
Info: suricata: time elapsed 0.018s

[2025-05-17 21:15:36,641] INFO in utils: suricata stderr: Error: pcap: datalink type 105 not (yet) supported in module PcapFile.
Error: pcap: pcap file reader thread failed to initialize

[2025-05-17 21:15:36,641] INFO in utils: suricata stderr: Error: pcap: datalink type 105 not (yet) supported in module PcapFile.
Error: pcap: pcap file reader thread failed to initialize

[2025-05-17 21:15:36,642] ERROR in utils: Suricata不支持的数据链路类型: Error: pcap: datalink type 105 not (yet) supported in module PcapFile.
Error: pcap: pcap file reader thread failed to initialize

[2025-05-17 21:15:36,642] ERROR in utils: Suricata不支持的数据链路类型: Error: pcap: datalink type 105 not (yet) supported in module PcapFile.
Error: pcap: pcap file reader thread failed to initialize

[2025-05-17 21:15:36,642] ERROR in routes: PCAP格式不兼容: PCAP文件包含Suricata不支持的数据链路类型，请使用标准的以太网捕获格式
[2025-05-17 21:15:36,642] INFO in routes: 尝试将PCAP文件转换为: /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap
[2025-05-17 21:15:36,642] INFO in utils: 尝试转换PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap -> /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap
[2025-05-17 21:15:36,642] INFO in utils: 尝试转换PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap -> /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap
[2025-05-17 21:15:36,643] INFO in utils: 输入文件大小: 509929 字节
[2025-05-17 21:15:36,643] INFO in utils: 输入文件大小: 509929 字节
[2025-05-17 21:15:36,643] INFO in utils: 使用tcpdump转换格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap
[2025-05-17 21:15:36,643] INFO in utils: 使用tcpdump转换格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap
[2025-05-17 21:15:36,643] INFO in utils: 执行tcpdump转换命令: tcpdump -r /home/taoli/NIDS_ByTaoLi/backend/uploads/ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap -w /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap -s 0
[2025-05-17 21:15:36,643] INFO in utils: 执行tcpdump转换命令: tcpdump -r /home/taoli/NIDS_ByTaoLi/backend/uploads/ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap -w /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap -s 0
[2025-05-17 21:15:36,649] INFO in utils: 尝试使用editcap转换为以太网格式: editcap -T ether /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap.ether
[2025-05-17 21:15:36,649] INFO in utils: 尝试使用editcap转换为以太网格式: editcap -T ether /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap.ether
[2025-05-17 21:15:36,665] INFO in utils: 使用editcap成功转换为以太网格式
[2025-05-17 21:15:36,665] INFO in utils: 使用editcap成功转换为以太网格式
[2025-05-17 21:15:36,665] INFO in utils: PCAP文件转换成功: /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap, 大小: 752064 字节
[2025-05-17 21:15:36,665] INFO in utils: PCAP文件转换成功: /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap, 大小: 752064 字节
[2025-05-17 21:15:36,668] INFO in utils: 转换后文件类型: /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap: pcapng capture file - version 1.0

[2025-05-17 21:15:36,668] INFO in utils: 转换后文件类型: /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap: pcapng capture file - version 1.0

[2025-05-17 21:15:36,668] INFO in routes: 成功转换PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap -> /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap
[2025-05-17 21:15:36,669] INFO in routes: 执行Suricata命令(default模式): /usr/bin/suricata -c /etc/suricata/suricata.yaml -r /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap -v -k none --set outputs.eve-log.filename=/home/taoli/NIDS_ByTaoLi/backend/uploads/ec7dd448-c6a7-4aac-99dc-09d6dbada65f_eve.json
[2025-05-17 21:15:37,808] INFO in routes: Suricata输出: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'

[2025-05-17 21:15:37,808] ERROR in routes: Suricata分析失败 (返回码 -11): 
[2025-05-17 21:15:37,809] ERROR in routes: Suricata可能遇到了段错误或内存访问问题，返回码: -11
[2025-05-17 21:15:37,812] INFO in routes: PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap: pcapng capture file - version 1.0

[2025-05-17 21:15:37,815] INFO in routes: tcpdump检查结果: reading from file /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap, link-type EN10MB (Ethernet), snapshot length 65535

[2025-05-17 21:15:37,816] WARNING in routes: 默认模式分析失败: Suricata处理此PCAP文件时崩溃 (返回码: -11)，可能包含特殊的数据包结构，尝试安全模式...
[2025-05-17 21:15:37,816] INFO in routes: 执行Suricata命令(safe模式): /usr/bin/suricata -c /etc/suricata/suricata.yaml --runmode=single -k none -r /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap -v --set outputs.eve-log.filename=/home/taoli/NIDS_ByTaoLi/backend/uploads/ec7dd448-c6a7-4aac-99dc-09d6dbada65f_eve.json
[2025-05-17 21:15:38,944] INFO in routes: Suricata输出: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'

[2025-05-17 21:15:38,944] ERROR in routes: Suricata分析失败 (返回码 -11): 
[2025-05-17 21:15:38,945] ERROR in routes: Suricata可能遇到了段错误或内存访问问题，返回码: -11
[2025-05-17 21:15:38,948] INFO in routes: PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap: pcapng capture file - version 1.0

[2025-05-17 21:15:38,951] INFO in routes: tcpdump检查结果: reading from file /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap, link-type EN10MB (Ethernet), snapshot length 65535

[2025-05-17 21:15:38,951] WARNING in routes: 安全模式分析失败: Suricata处理此PCAP文件时崩溃 (返回码: -11)，可能包含特殊的数据包结构，尝试最小规则集模式...
[2025-05-17 21:15:38,951] INFO in routes: 执行Suricata命令(minimal模式): /usr/bin/suricata --disable-detection -k none -c /etc/suricata/suricata.yaml -r /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap -v --set outputs.eve-log.filename=/home/taoli/NIDS_ByTaoLi/backend/uploads/ec7dd448-c6a7-4aac-99dc-09d6dbada65f_eve.json
[2025-05-17 21:15:40,079] INFO in routes: Suricata输出: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'

[2025-05-17 21:15:40,080] ERROR in routes: Suricata分析失败 (返回码 -11): 
[2025-05-17 21:15:40,080] ERROR in routes: Suricata可能遇到了段错误或内存访问问题，返回码: -11
[2025-05-17 21:15:40,083] INFO in routes: PCAP文件格式: /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap: pcapng capture file - version 1.0

[2025-05-17 21:15:40,086] INFO in routes: tcpdump检查结果: reading from file /home/taoli/NIDS_ByTaoLi/backend/uploads/converted_ec7dd448-c6a7-4aac-99dc-09d6dbada65f_wifi.pcap, link-type EN10MB (Ethernet), snapshot length 65535

[2025-05-17 21:15:40,086] ERROR in routes: Suricata分析失败: Suricata分析失败: Suricata处理此PCAP文件时崩溃 (返回码: -11)，可能包含特殊的数据包结构
[2025-05-17 21:16:39,235] INFO in __init__: 应用已启动
[2025-05-17 21:17:04,526] INFO in __init__: 应用已启动
[2025-05-17 21:18:16,236] INFO in __init__: 应用已启动
[2025-05-17 21:18:43,757] INFO in __init__: 应用已启动
[2025-05-17 21:19:20,648] INFO in __init__: 应用已启动
[2025-05-17 21:19:21,012] INFO in __init__: 应用已启动
[2025-05-17 21:20:37,010] INFO in routes: 上传目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 21:20:37,011] INFO in routes: 保存PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/d4b891dd-32a7-41bc-ac7f-1e3b6423548c_1.pcap
[2025-05-17 21:20:37,012] INFO in routes: PCAP文件已保存: /home/taoli/NIDS_ByTaoLi/backend/uploads/d4b891dd-32a7-41bc-ac7f-1e3b6423548c_1.pcap, 大小: 300355 字节
[2025-05-17 21:20:37,017] INFO in routes: 开始分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/d4b891dd-32a7-41bc-ac7f-1e3b6423548c_1.pcap, 输出目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 21:20:37,018] INFO in routes: 已创建PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/d4b891dd-32a7-41bc-ac7f-1e3b6423548c_1.pcap.bak
[2025-05-17 21:20:37,018] INFO in routes: 使用Suricata分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/d4b891dd-32a7-41bc-ac7f-1e3b6423548c_1.pcap
[2025-05-17 21:20:37,018] INFO in routes: PCAP文件大小: 300355 字节
[2025-05-17 21:20:37,019] INFO in routes: 使用直接模式命令: /usr/bin/suricata -c /etc/suricata/suricata.yaml -r /home/taoli/NIDS_ByTaoLi/backend/uploads/d4b891dd-32a7-41bc-ac7f-1e3b6423548c_1.pcap -v -k none
[2025-05-17 21:20:37,105] INFO in routes: Suricata输出: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed,...
[2025-05-17 21:20:37,105] INFO in routes: Suricata返回码: 0
[2025-05-17 21:20:37,105] INFO in routes: 从/var/log/suricata/eve.json复制结果到/home/taoli/NIDS_ByTaoLi/backend/uploads/d4b891dd-32a7-41bc-ac7f-1e3b6423548c_eve.json
[2025-05-17 21:20:37,108] INFO in routes: 处理eve.json文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/d4b891dd-32a7-41bc-ac7f-1e3b6423548c_eve.json, 大小: 953552 字节
[2025-05-17 21:20:37,115] WARNING in routes: 处理了1771行，发现0个告警，但没有保存任何告警记录
[2025-05-17 21:20:37,115] INFO in routes: 已删除临时分析结果文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/d4b891dd-32a7-41bc-ac7f-1e3b6423548c_eve.json
[2025-05-17 21:20:37,115] INFO in routes: 已删除PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/d4b891dd-32a7-41bc-ac7f-1e3b6423548c_1.pcap.bak
[2025-05-17 21:20:43,513] INFO in routes: 上传目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 21:20:43,514] INFO in routes: 保存PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/94f887b4-dc8c-4403-8803-1548c3a756cd_wifi.pcap
[2025-05-17 21:20:43,515] INFO in routes: PCAP文件已保存: /home/taoli/NIDS_ByTaoLi/backend/uploads/94f887b4-dc8c-4403-8803-1548c3a756cd_wifi.pcap, 大小: 509929 字节
[2025-05-17 21:20:43,517] INFO in routes: 开始分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/94f887b4-dc8c-4403-8803-1548c3a756cd_wifi.pcap, 输出目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 21:20:43,519] INFO in routes: 已创建PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/94f887b4-dc8c-4403-8803-1548c3a756cd_wifi.pcap.bak
[2025-05-17 21:20:43,519] INFO in routes: 使用Suricata分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/94f887b4-dc8c-4403-8803-1548c3a756cd_wifi.pcap
[2025-05-17 21:20:43,519] INFO in routes: PCAP文件大小: 509929 字节
[2025-05-17 21:20:43,519] INFO in routes: 使用直接模式命令: /usr/bin/suricata -c /etc/suricata/suricata.yaml -r /home/taoli/NIDS_ByTaoLi/backend/uploads/94f887b4-dc8c-4403-8803-1548c3a756cd_wifi.pcap -v -k none
[2025-05-17 21:20:43,599] INFO in routes: Suricata输出: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed,...
[2025-05-17 21:20:43,599] INFO in routes: Suricata错误: Error: pcap: datalink type 105 not (yet) supported in module PcapFile.
Error: pcap: pcap file reader thread failed to initialize
...
[2025-05-17 21:20:43,599] INFO in routes: Suricata返回码: 0
[2025-05-17 21:20:43,599] INFO in routes: 从/var/log/suricata/eve.json复制结果到/home/taoli/NIDS_ByTaoLi/backend/uploads/94f887b4-dc8c-4403-8803-1548c3a756cd_eve.json
[2025-05-17 21:20:43,600] INFO in routes: 处理eve.json文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/94f887b4-dc8c-4403-8803-1548c3a756cd_eve.json, 大小: 953552 字节
[2025-05-17 21:20:43,608] WARNING in routes: 处理了1771行，发现0个告警，但没有保存任何告警记录
[2025-05-17 21:20:43,608] INFO in routes: 已删除临时分析结果文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/94f887b4-dc8c-4403-8803-1548c3a756cd_eve.json
[2025-05-17 21:20:43,609] INFO in routes: 已删除PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/94f887b4-dc8c-4403-8803-1548c3a756cd_wifi.pcap.bak
[2025-05-17 21:21:35,111] INFO in routes: 上传目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 21:21:35,111] INFO in routes: 保存PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/74647fe6-d2f2-4e14-98f9-ada7d416e503_Metasploit_Payload.pcap
[2025-05-17 21:21:35,113] INFO in routes: PCAP文件已保存: /home/taoli/NIDS_ByTaoLi/backend/uploads/74647fe6-d2f2-4e14-98f9-ada7d416e503_Metasploit_Payload.pcap, 大小: 537631 字节
[2025-05-17 21:21:35,114] INFO in routes: 开始分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/74647fe6-d2f2-4e14-98f9-ada7d416e503_Metasploit_Payload.pcap, 输出目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 21:21:35,115] INFO in routes: 已创建PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/74647fe6-d2f2-4e14-98f9-ada7d416e503_Metasploit_Payload.pcap.bak
[2025-05-17 21:21:35,115] INFO in routes: 使用Suricata分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/74647fe6-d2f2-4e14-98f9-ada7d416e503_Metasploit_Payload.pcap
[2025-05-17 21:21:35,116] INFO in routes: PCAP文件大小: 537631 字节
[2025-05-17 21:21:35,116] INFO in routes: 使用直接模式命令: /usr/bin/suricata -c /etc/suricata/suricata.yaml -r /home/taoli/NIDS_ByTaoLi/backend/uploads/74647fe6-d2f2-4e14-98f9-ada7d416e503_Metasploit_Payload.pcap -v -k none
[2025-05-17 21:21:35,197] INFO in routes: Suricata输出: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed,...
[2025-05-17 21:21:35,197] INFO in routes: Suricata返回码: 0
[2025-05-17 21:21:35,198] INFO in routes: 从/var/log/suricata/eve.json复制结果到/home/taoli/NIDS_ByTaoLi/backend/uploads/74647fe6-d2f2-4e14-98f9-ada7d416e503_eve.json
[2025-05-17 21:21:35,199] INFO in routes: 处理eve.json文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/74647fe6-d2f2-4e14-98f9-ada7d416e503_eve.json, 大小: 965421 字节
[2025-05-17 21:21:35,205] WARNING in routes: 处理了1800行，发现0个告警，但没有保存任何告警记录
[2025-05-17 21:21:35,206] INFO in routes: 已删除临时分析结果文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/74647fe6-d2f2-4e14-98f9-ada7d416e503_eve.json
[2025-05-17 21:21:35,206] INFO in routes: 已删除PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/74647fe6-d2f2-4e14-98f9-ada7d416e503_Metasploit_Payload.pcap.bak
[2025-05-17 21:21:45,934] INFO in routes: 上传目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 21:21:45,934] INFO in routes: 保存PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/a15a5104-8686-410a-9c68-18535296abc9_Metasploit_Payload.pcap
[2025-05-17 21:21:45,934] INFO in routes: PCAP文件已保存: /home/taoli/NIDS_ByTaoLi/backend/uploads/a15a5104-8686-410a-9c68-18535296abc9_Metasploit_Payload.pcap, 大小: 537631 字节
[2025-05-17 21:21:45,936] INFO in routes: 开始分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/a15a5104-8686-410a-9c68-18535296abc9_Metasploit_Payload.pcap, 输出目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 21:21:45,936] INFO in routes: 已创建PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/a15a5104-8686-410a-9c68-18535296abc9_Metasploit_Payload.pcap.bak
[2025-05-17 21:21:45,936] INFO in routes: 使用Suricata分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/a15a5104-8686-410a-9c68-18535296abc9_Metasploit_Payload.pcap
[2025-05-17 21:21:45,936] INFO in routes: PCAP文件大小: 537631 字节
[2025-05-17 21:21:45,936] INFO in routes: 使用直接模式命令: /usr/bin/suricata -c /etc/suricata/suricata.yaml -r /home/taoli/NIDS_ByTaoLi/backend/uploads/a15a5104-8686-410a-9c68-18535296abc9_Metasploit_Payload.pcap -v -k none
[2025-05-17 21:21:46,013] INFO in routes: Suricata输出: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed,...
[2025-05-17 21:21:46,013] INFO in routes: Suricata返回码: 0
[2025-05-17 21:21:46,013] INFO in routes: 从/var/log/suricata/eve.json复制结果到/home/taoli/NIDS_ByTaoLi/backend/uploads/a15a5104-8686-410a-9c68-18535296abc9_eve.json
[2025-05-17 21:21:46,014] INFO in routes: 处理eve.json文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/a15a5104-8686-410a-9c68-18535296abc9_eve.json, 大小: 977290 字节
[2025-05-17 21:21:46,021] WARNING in routes: 处理了1829行，发现0个告警，但没有保存任何告警记录
[2025-05-17 21:21:46,021] INFO in routes: 已删除临时分析结果文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/a15a5104-8686-410a-9c68-18535296abc9_eve.json
[2025-05-17 21:21:46,022] INFO in routes: 已删除PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/a15a5104-8686-410a-9c68-18535296abc9_Metasploit_Payload.pcap.bak
[2025-05-17 21:22:12,737] INFO in routes: 上传目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 21:22:12,737] INFO in routes: 保存PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/61f33824-4ac0-4e1f-b2ec-b2a501c7064f_Metasploit_Payload.pcap
[2025-05-17 21:22:12,738] INFO in routes: PCAP文件已保存: /home/taoli/NIDS_ByTaoLi/backend/uploads/61f33824-4ac0-4e1f-b2ec-b2a501c7064f_Metasploit_Payload.pcap, 大小: 537631 字节
[2025-05-17 21:22:12,739] INFO in routes: 开始分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/61f33824-4ac0-4e1f-b2ec-b2a501c7064f_Metasploit_Payload.pcap, 输出目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 21:22:12,740] INFO in routes: 已创建PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/61f33824-4ac0-4e1f-b2ec-b2a501c7064f_Metasploit_Payload.pcap.bak
[2025-05-17 21:22:12,740] INFO in routes: 使用Suricata分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/61f33824-4ac0-4e1f-b2ec-b2a501c7064f_Metasploit_Payload.pcap
[2025-05-17 21:22:12,740] INFO in routes: PCAP文件大小: 537631 字节
[2025-05-17 21:22:12,740] INFO in routes: 使用直接模式命令: /usr/bin/suricata -c /etc/suricata/suricata.yaml -r /home/taoli/NIDS_ByTaoLi/backend/uploads/61f33824-4ac0-4e1f-b2ec-b2a501c7064f_Metasploit_Payload.pcap -v -k none
[2025-05-17 21:22:12,809] INFO in routes: Suricata输出: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed,...
[2025-05-17 21:22:12,809] INFO in routes: Suricata返回码: 0
[2025-05-17 21:22:12,809] INFO in routes: 从/var/log/suricata/eve.json复制结果到/home/taoli/NIDS_ByTaoLi/backend/uploads/61f33824-4ac0-4e1f-b2ec-b2a501c7064f_eve.json
[2025-05-17 21:22:12,810] INFO in routes: 处理eve.json文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/61f33824-4ac0-4e1f-b2ec-b2a501c7064f_eve.json, 大小: 989159 字节
[2025-05-17 21:22:12,818] WARNING in routes: 处理了1858行，发现0个告警，但没有保存任何告警记录
[2025-05-17 21:22:12,819] INFO in routes: 已删除临时分析结果文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/61f33824-4ac0-4e1f-b2ec-b2a501c7064f_eve.json
[2025-05-17 21:22:12,819] INFO in routes: 已删除PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/61f33824-4ac0-4e1f-b2ec-b2a501c7064f_Metasploit_Payload.pcap.bak
[2025-05-17 21:27:00,355] INFO in __init__: 应用已启动
[2025-05-17 21:27:00,662] INFO in __init__: 应用已启动
[2025-05-17 21:27:14,135] INFO in routes: 上传目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 21:27:14,136] INFO in routes: 保存PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/73ac45f6-3d67-4133-bdef-32c5d92947b8_webshell.pcap
[2025-05-17 21:27:14,137] INFO in routes: PCAP文件已保存: /home/taoli/NIDS_ByTaoLi/backend/uploads/73ac45f6-3d67-4133-bdef-32c5d92947b8_webshell.pcap, 大小: 264424 字节
[2025-05-17 21:27:14,139] INFO in routes: 开始分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/73ac45f6-3d67-4133-bdef-32c5d92947b8_webshell.pcap, 输出目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 21:27:14,139] INFO in routes: 已创建PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/73ac45f6-3d67-4133-bdef-32c5d92947b8_webshell.pcap.bak
[2025-05-17 21:27:14,139] INFO in routes: 使用Suricata分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/73ac45f6-3d67-4133-bdef-32c5d92947b8_webshell.pcap
[2025-05-17 21:27:14,140] INFO in routes: PCAP文件大小: 264424 字节
[2025-05-17 21:27:14,140] INFO in routes: 使用直接模式命令: /usr/bin/suricata -c /etc/suricata/suricata.yaml -r /home/taoli/NIDS_ByTaoLi/backend/uploads/73ac45f6-3d67-4133-bdef-32c5d92947b8_webshell.pcap -v -k none
[2025-05-17 21:27:14,231] INFO in routes: Suricata输出: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed,...
[2025-05-17 21:27:14,231] INFO in routes: Suricata返回码: 0
[2025-05-17 21:27:14,231] INFO in routes: 从/var/log/suricata/eve.json复制结果到/home/taoli/NIDS_ByTaoLi/backend/uploads/73ac45f6-3d67-4133-bdef-32c5d92947b8_eve.json
[2025-05-17 21:27:14,233] INFO in routes: 处理eve.json文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/73ac45f6-3d67-4133-bdef-32c5d92947b8_eve.json, 大小: 1016996 字节
[2025-05-17 21:27:14,240] WARNING in routes: 处理了1915行，发现0个告警，但没有保存任何告警记录
[2025-05-17 21:27:14,241] INFO in routes: 已删除临时分析结果文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/73ac45f6-3d67-4133-bdef-32c5d92947b8_eve.json
[2025-05-17 21:27:14,241] INFO in routes: 已删除PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/73ac45f6-3d67-4133-bdef-32c5d92947b8_webshell.pcap.bak
[2025-05-17 21:30:57,915] INFO in routes: 上传目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 21:30:57,915] INFO in routes: 保存PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/fb863b76-db98-460c-938c-acba8baf4611_icmp_.pcapng
[2025-05-17 21:30:57,915] INFO in routes: PCAP文件已保存: /home/taoli/NIDS_ByTaoLi/backend/uploads/fb863b76-db98-460c-938c-acba8baf4611_icmp_.pcapng, 大小: 92756 字节
[2025-05-17 21:30:57,918] INFO in routes: 开始分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/fb863b76-db98-460c-938c-acba8baf4611_icmp_.pcapng, 输出目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 21:30:57,919] INFO in routes: 已创建PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/fb863b76-db98-460c-938c-acba8baf4611_icmp_.pcapng.bak
[2025-05-17 21:30:57,919] INFO in routes: 使用Suricata分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/fb863b76-db98-460c-938c-acba8baf4611_icmp_.pcapng
[2025-05-17 21:30:57,919] INFO in routes: PCAP文件大小: 92756 字节
[2025-05-17 21:30:57,919] INFO in routes: 使用直接模式命令: /usr/bin/suricata -c /etc/suricata/suricata.yaml -r /home/taoli/NIDS_ByTaoLi/backend/uploads/fb863b76-db98-460c-938c-acba8baf4611_icmp_.pcapng -v -k none
[2025-05-17 21:30:57,994] INFO in routes: Suricata输出: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed,...
[2025-05-17 21:30:57,994] INFO in routes: Suricata返回码: 0
[2025-05-17 21:30:57,994] INFO in routes: 从/var/log/suricata/eve.json复制结果到/home/taoli/NIDS_ByTaoLi/backend/uploads/fb863b76-db98-460c-938c-acba8baf4611_eve.json
[2025-05-17 21:30:57,995] INFO in routes: 处理eve.json文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/fb863b76-db98-460c-938c-acba8baf4611_eve.json, 大小: 1020872 字节
[2025-05-17 21:30:58,002] WARNING in routes: 处理了1923行，发现0个告警，但没有保存任何告警记录
[2025-05-17 21:30:58,003] INFO in routes: 已删除临时分析结果文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/fb863b76-db98-460c-938c-acba8baf4611_eve.json
[2025-05-17 21:30:58,003] INFO in routes: 已删除PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/fb863b76-db98-460c-938c-acba8baf4611_icmp_.pcapng.bak
[2025-05-17 21:34:05,547] INFO in __init__: 应用已启动
[2025-05-17 21:34:50,179] INFO in __init__: 应用已启动
[2025-05-17 21:35:24,655] INFO in __init__: 应用已启动
[2025-05-17 21:36:25,052] INFO in __init__: 应用已启动
[2025-05-17 21:36:25,444] INFO in __init__: 应用已启动
[2025-05-17 21:36:59,516] INFO in routes: 上传目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 21:36:59,517] INFO in routes: 保存PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/c92ed9eb-8c59-4c3c-bde9-770331f9536e_pcap
[2025-05-17 21:36:59,517] INFO in routes: PCAP文件已保存: /home/taoli/NIDS_ByTaoLi/backend/uploads/c92ed9eb-8c59-4c3c-bde9-770331f9536e_pcap, 大小: 1506 字节
[2025-05-17 21:36:59,524] INFO in routes: 开始分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/c92ed9eb-8c59-4c3c-bde9-770331f9536e_pcap, 输出目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 21:36:59,525] INFO in routes: 已创建PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/c92ed9eb-8c59-4c3c-bde9-770331f9536e_pcap.bak
[2025-05-17 21:36:59,525] INFO in routes: 使用Suricata分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/c92ed9eb-8c59-4c3c-bde9-770331f9536e_pcap
[2025-05-17 21:36:59,525] INFO in routes: PCAP文件大小: 1506 字节
[2025-05-17 21:36:59,525] INFO in routes: 使用直接模式命令: /usr/bin/suricata -c /etc/suricata/suricata.yaml -r /home/taoli/NIDS_ByTaoLi/backend/uploads/c92ed9eb-8c59-4c3c-bde9-770331f9536e_pcap -v -k none
[2025-05-17 21:36:59,667] INFO in routes: Suricata输出: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed,...
[2025-05-17 21:36:59,667] INFO in routes: Suricata返回码: 0
[2025-05-17 21:36:59,668] INFO in routes: 从/var/log/suricata/eve.json复制结果到/home/taoli/NIDS_ByTaoLi/backend/uploads/c92ed9eb-8c59-4c3c-bde9-770331f9536e_eve.json
[2025-05-17 21:36:59,670] INFO in routes: 处理eve.json文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/c92ed9eb-8c59-4c3c-bde9-770331f9536e_eve.json, 大小: 1020872 字节
[2025-05-17 21:36:59,671] INFO in routes: Eve.json前几行内容:
[2025-05-17 21:36:59,671] INFO in routes: 行 1: {"timestamp":"2025-05-17T18:24:39.067554+0800","flow_id":1978993307944531,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":48522,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":42719,"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"A","tx_id":0,"opcode":0}}...
[2025-05-17 21:36:59,671] INFO in routes: 行 2: {"timestamp":"2025-05-17T18:24:39.067777+0800","flow_id":1979950945253980,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":54214,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":24352,"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"AAAA","tx_id":0,"opcode":0}}...
[2025-05-17 21:36:59,671] INFO in routes: 行 3: {"timestamp":"2025-05-17T18:24:39.074028+0800","flow_id":1978993307944531,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":48522,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":42719,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"A","rcode":"NOERROR","answers":[{"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"CNAME","ttl":30,"rdata":"mirrors.tuna.t...
[2025-05-17 21:36:59,671] INFO in routes: 行 4: {"timestamp":"2025-05-17T18:24:39.074734+0800","flow_id":1979950945253980,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":54214,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":24352,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"AAAA","rcode":"NOERROR","answers":[{"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"CNAME","ttl":171,"rdata":"mirrors.tu...
[2025-05-17 21:36:59,671] INFO in routes: 行 5: {"timestamp":"2025-05-17T18:24:39.273815+0800","flow_id":2020455330372048,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":37523,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":47356,"rrname":"mirrors.aliyun.com","rrtype":"A","tx_id":0,"opcode":0}}...
[2025-05-17 21:36:59,671] INFO in routes: 行 6: {"timestamp":"2025-05-17T18:24:39.274046+0800","flow_id":2021445079687099,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":35878,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":56505,"rrname":"mirrors.aliyun.com","rrtype":"AAAA","tx_id":0,"opcode":0}}...
[2025-05-17 21:36:59,671] INFO in routes: 行 7: {"timestamp":"2025-05-17T18:24:39.280764+0800","flow_id":2020455330372048,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":37523,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":47356,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"mirrors.aliyun.com","rrtype":"A","rcode":"NOERROR","answers":[{"rrname":"mirrors.aliyun.com","rrtype":"CNAME","ttl":30,"rdata":"mirrors.aliyun.com.w.alikunl...
[2025-05-17 21:36:59,671] INFO in routes: 行 8: {"timestamp":"2025-05-17T18:24:39.281564+0800","flow_id":2021445079687099,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":35878,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":56505,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"mirrors.aliyun.com","rrtype":"AAAA","rcode":"NOERROR","answers":[{"rrname":"mirrors.aliyun.com","rrtype":"CNAME","ttl":41,"rdata":"mirrors.aliyun.com.w.alik...
[2025-05-17 21:36:59,672] INFO in routes: 行 9: {"timestamp":"2025-05-17T18:24:39.281812+0800","flow_id":2054802404068717,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":35829,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":42539,"rrname":"mirrors.aliyun.com.w.alikunlun.com","rrtype":"AAAA","tx_id":0,"opcode":0}}...
[2025-05-17 21:36:59,672] INFO in routes: 行 10: {"timestamp":"2025-05-17T18:24:39.306178+0800","flow_id":2054802404068717,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":35829,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":42539,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"mirrors.aliyun.com.w.alikunlun.com","rrtype":"AAAA","rcode":"NOERROR","authorities":[{"rrname":"w.alikunlun.com","rrtype":"SOA","ttl":89,"soa":{"mname":"ns3...
[2025-05-17 21:36:59,682] WARNING in routes: 处理了1923行，发现0个告警，但没有保存任何告警记录
[2025-05-17 21:36:59,682] WARNING in routes: 未发现告警，可能是没有匹配的规则或PCAP文件内容没有触发告警
[2025-05-17 21:36:59,682] INFO in routes: 保留eve.json文件用于分析调试: /home/taoli/NIDS_ByTaoLi/backend/uploads/c92ed9eb-8c59-4c3c-bde9-770331f9536e_eve.json
[2025-05-17 21:36:59,683] INFO in routes: 已删除PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/c92ed9eb-8c59-4c3c-bde9-770331f9536e_pcap.bak
[2025-05-17 21:37:22,233] INFO in routes: 上传目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 21:37:22,234] INFO in routes: 保存PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/9fe6a5d6-44ae-4311-b342-05fa3de7bbbb_pcap
[2025-05-17 21:37:22,234] INFO in routes: PCAP文件已保存: /home/taoli/NIDS_ByTaoLi/backend/uploads/9fe6a5d6-44ae-4311-b342-05fa3de7bbbb_pcap, 大小: 1506 字节
[2025-05-17 21:37:22,235] INFO in routes: 开始分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/9fe6a5d6-44ae-4311-b342-05fa3de7bbbb_pcap, 输出目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 21:37:22,235] INFO in routes: 已创建PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/9fe6a5d6-44ae-4311-b342-05fa3de7bbbb_pcap.bak
[2025-05-17 21:37:22,235] INFO in routes: 使用Suricata分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/9fe6a5d6-44ae-4311-b342-05fa3de7bbbb_pcap
[2025-05-17 21:37:22,235] INFO in routes: PCAP文件大小: 1506 字节
[2025-05-17 21:37:22,235] INFO in routes: 使用直接模式命令: /usr/bin/suricata -c /etc/suricata/suricata.yaml -r /home/taoli/NIDS_ByTaoLi/backend/uploads/9fe6a5d6-44ae-4311-b342-05fa3de7bbbb_pcap -v -k none
[2025-05-17 21:37:22,314] INFO in routes: Suricata输出: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed,...
[2025-05-17 21:37:22,314] INFO in routes: Suricata返回码: 0
[2025-05-17 21:37:22,314] INFO in routes: 从/var/log/suricata/eve.json复制结果到/home/taoli/NIDS_ByTaoLi/backend/uploads/9fe6a5d6-44ae-4311-b342-05fa3de7bbbb_eve.json
[2025-05-17 21:37:22,315] INFO in routes: 处理eve.json文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/9fe6a5d6-44ae-4311-b342-05fa3de7bbbb_eve.json, 大小: 1020872 字节
[2025-05-17 21:37:22,315] INFO in routes: Eve.json前几行内容:
[2025-05-17 21:37:22,316] INFO in routes: 行 1: {"timestamp":"2025-05-17T18:24:39.067554+0800","flow_id":1978993307944531,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":48522,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":42719,"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"A","tx_id":0,"opcode":0}}...
[2025-05-17 21:37:22,316] INFO in routes: 行 2: {"timestamp":"2025-05-17T18:24:39.067777+0800","flow_id":1979950945253980,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":54214,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":24352,"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"AAAA","tx_id":0,"opcode":0}}...
[2025-05-17 21:37:22,316] INFO in routes: 行 3: {"timestamp":"2025-05-17T18:24:39.074028+0800","flow_id":1978993307944531,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":48522,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":42719,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"A","rcode":"NOERROR","answers":[{"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"CNAME","ttl":30,"rdata":"mirrors.tuna.t...
[2025-05-17 21:37:22,316] INFO in routes: 行 4: {"timestamp":"2025-05-17T18:24:39.074734+0800","flow_id":1979950945253980,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":54214,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":24352,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"AAAA","rcode":"NOERROR","answers":[{"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"CNAME","ttl":171,"rdata":"mirrors.tu...
[2025-05-17 21:37:22,316] INFO in routes: 行 5: {"timestamp":"2025-05-17T18:24:39.273815+0800","flow_id":2020455330372048,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":37523,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":47356,"rrname":"mirrors.aliyun.com","rrtype":"A","tx_id":0,"opcode":0}}...
[2025-05-17 21:37:22,316] INFO in routes: 行 6: {"timestamp":"2025-05-17T18:24:39.274046+0800","flow_id":2021445079687099,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":35878,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":56505,"rrname":"mirrors.aliyun.com","rrtype":"AAAA","tx_id":0,"opcode":0}}...
[2025-05-17 21:37:22,316] INFO in routes: 行 7: {"timestamp":"2025-05-17T18:24:39.280764+0800","flow_id":2020455330372048,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":37523,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":47356,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"mirrors.aliyun.com","rrtype":"A","rcode":"NOERROR","answers":[{"rrname":"mirrors.aliyun.com","rrtype":"CNAME","ttl":30,"rdata":"mirrors.aliyun.com.w.alikunl...
[2025-05-17 21:37:22,316] INFO in routes: 行 8: {"timestamp":"2025-05-17T18:24:39.281564+0800","flow_id":2021445079687099,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":35878,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":56505,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"mirrors.aliyun.com","rrtype":"AAAA","rcode":"NOERROR","answers":[{"rrname":"mirrors.aliyun.com","rrtype":"CNAME","ttl":41,"rdata":"mirrors.aliyun.com.w.alik...
[2025-05-17 21:37:22,316] INFO in routes: 行 9: {"timestamp":"2025-05-17T18:24:39.281812+0800","flow_id":2054802404068717,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":35829,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":42539,"rrname":"mirrors.aliyun.com.w.alikunlun.com","rrtype":"AAAA","tx_id":0,"opcode":0}}...
[2025-05-17 21:37:22,316] INFO in routes: 行 10: {"timestamp":"2025-05-17T18:24:39.306178+0800","flow_id":2054802404068717,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":35829,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":42539,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"mirrors.aliyun.com.w.alikunlun.com","rrtype":"AAAA","rcode":"NOERROR","authorities":[{"rrname":"w.alikunlun.com","rrtype":"SOA","ttl":89,"soa":{"mname":"ns3...
[2025-05-17 21:37:22,324] WARNING in routes: 处理了1923行，发现0个告警，但没有保存任何告警记录
[2025-05-17 21:37:22,324] WARNING in routes: 未发现告警，可能是没有匹配的规则或PCAP文件内容没有触发告警
[2025-05-17 21:37:22,324] INFO in routes: 保留eve.json文件用于分析调试: /home/taoli/NIDS_ByTaoLi/backend/uploads/9fe6a5d6-44ae-4311-b342-05fa3de7bbbb_eve.json
[2025-05-17 21:37:22,324] INFO in routes: 已删除PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/9fe6a5d6-44ae-4311-b342-05fa3de7bbbb_pcap.bak
[2025-05-17 21:43:29,275] INFO in routes: 上传目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 21:43:29,280] INFO in routes: 保存PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/2f7e5f17-aa66-4526-8b2d-3e44af466336_pcap
[2025-05-17 21:43:29,283] INFO in routes: PCAP文件已保存: /home/taoli/NIDS_ByTaoLi/backend/uploads/2f7e5f17-aa66-4526-8b2d-3e44af466336_pcap, 大小: 1506 字节
[2025-05-17 21:43:29,294] INFO in routes: 开始分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/2f7e5f17-aa66-4526-8b2d-3e44af466336_pcap, 输出目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 21:43:29,296] INFO in routes: 已创建PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/2f7e5f17-aa66-4526-8b2d-3e44af466336_pcap.bak
[2025-05-17 21:43:29,296] INFO in routes: 使用Suricata分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/2f7e5f17-aa66-4526-8b2d-3e44af466336_pcap
[2025-05-17 21:43:29,296] INFO in routes: PCAP文件大小: 1506 字节
[2025-05-17 21:43:29,297] INFO in routes: 使用直接模式命令: /usr/bin/suricata -c /etc/suricata/suricata.yaml -r /home/taoli/NIDS_ByTaoLi/backend/uploads/2f7e5f17-aa66-4526-8b2d-3e44af466336_pcap -v -k none
[2025-05-17 21:43:29,403] INFO in routes: Suricata输出: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed,...
[2025-05-17 21:43:29,404] INFO in routes: Suricata返回码: 0
[2025-05-17 21:43:29,404] INFO in routes: 从/var/log/suricata/eve.json复制结果到/home/taoli/NIDS_ByTaoLi/backend/uploads/2f7e5f17-aa66-4526-8b2d-3e44af466336_eve.json
[2025-05-17 21:43:29,407] INFO in routes: 处理eve.json文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/2f7e5f17-aa66-4526-8b2d-3e44af466336_eve.json, 大小: 1020872 字节
[2025-05-17 21:43:29,407] INFO in routes: Eve.json前几行内容:
[2025-05-17 21:43:29,408] INFO in routes: 行 1: {"timestamp":"2025-05-17T18:24:39.067554+0800","flow_id":1978993307944531,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":48522,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":42719,"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"A","tx_id":0,"opcode":0}}...
[2025-05-17 21:43:29,408] INFO in routes: 行 2: {"timestamp":"2025-05-17T18:24:39.067777+0800","flow_id":1979950945253980,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":54214,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":24352,"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"AAAA","tx_id":0,"opcode":0}}...
[2025-05-17 21:43:29,408] INFO in routes: 行 3: {"timestamp":"2025-05-17T18:24:39.074028+0800","flow_id":1978993307944531,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":48522,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":42719,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"A","rcode":"NOERROR","answers":[{"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"CNAME","ttl":30,"rdata":"mirrors.tuna.t...
[2025-05-17 21:43:29,408] INFO in routes: 行 4: {"timestamp":"2025-05-17T18:24:39.074734+0800","flow_id":1979950945253980,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":54214,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":24352,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"AAAA","rcode":"NOERROR","answers":[{"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"CNAME","ttl":171,"rdata":"mirrors.tu...
[2025-05-17 21:43:29,408] INFO in routes: 行 5: {"timestamp":"2025-05-17T18:24:39.273815+0800","flow_id":2020455330372048,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":37523,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":47356,"rrname":"mirrors.aliyun.com","rrtype":"A","tx_id":0,"opcode":0}}...
[2025-05-17 21:43:29,409] INFO in routes: 行 6: {"timestamp":"2025-05-17T18:24:39.274046+0800","flow_id":2021445079687099,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":35878,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":56505,"rrname":"mirrors.aliyun.com","rrtype":"AAAA","tx_id":0,"opcode":0}}...
[2025-05-17 21:43:29,409] INFO in routes: 行 7: {"timestamp":"2025-05-17T18:24:39.280764+0800","flow_id":2020455330372048,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":37523,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":47356,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"mirrors.aliyun.com","rrtype":"A","rcode":"NOERROR","answers":[{"rrname":"mirrors.aliyun.com","rrtype":"CNAME","ttl":30,"rdata":"mirrors.aliyun.com.w.alikunl...
[2025-05-17 21:43:29,409] INFO in routes: 行 8: {"timestamp":"2025-05-17T18:24:39.281564+0800","flow_id":2021445079687099,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":35878,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":56505,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"mirrors.aliyun.com","rrtype":"AAAA","rcode":"NOERROR","answers":[{"rrname":"mirrors.aliyun.com","rrtype":"CNAME","ttl":41,"rdata":"mirrors.aliyun.com.w.alik...
[2025-05-17 21:43:29,409] INFO in routes: 行 9: {"timestamp":"2025-05-17T18:24:39.281812+0800","flow_id":2054802404068717,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":35829,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":42539,"rrname":"mirrors.aliyun.com.w.alikunlun.com","rrtype":"AAAA","tx_id":0,"opcode":0}}...
[2025-05-17 21:43:29,409] INFO in routes: 行 10: {"timestamp":"2025-05-17T18:24:39.306178+0800","flow_id":2054802404068717,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":35829,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":42539,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"mirrors.aliyun.com.w.alikunlun.com","rrtype":"AAAA","rcode":"NOERROR","authorities":[{"rrname":"w.alikunlun.com","rrtype":"SOA","ttl":89,"soa":{"mname":"ns3...
[2025-05-17 21:43:29,418] WARNING in routes: 处理了1923行，发现0个告警，但没有保存任何告警记录
[2025-05-17 21:43:29,418] WARNING in routes: 未发现告警，可能是没有匹配的规则或PCAP文件内容没有触发告警
[2025-05-17 21:43:29,418] INFO in routes: 保留eve.json文件用于分析调试: /home/taoli/NIDS_ByTaoLi/backend/uploads/2f7e5f17-aa66-4526-8b2d-3e44af466336_eve.json
[2025-05-17 21:43:29,419] INFO in routes: 已删除PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/2f7e5f17-aa66-4526-8b2d-3e44af466336_pcap.bak
[2025-05-17 21:44:05,155] INFO in routes: 上传目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 21:44:05,155] INFO in routes: 保存PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/856879a9-aa0c-430a-bec0-9243d87a78c0_pcap
[2025-05-17 21:44:05,155] INFO in routes: PCAP文件已保存: /home/taoli/NIDS_ByTaoLi/backend/uploads/856879a9-aa0c-430a-bec0-9243d87a78c0_pcap, 大小: 1506 字节
[2025-05-17 21:44:05,156] INFO in routes: 开始分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/856879a9-aa0c-430a-bec0-9243d87a78c0_pcap, 输出目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 21:44:05,157] INFO in routes: 已创建PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/856879a9-aa0c-430a-bec0-9243d87a78c0_pcap.bak
[2025-05-17 21:44:05,157] INFO in routes: 使用Suricata分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/856879a9-aa0c-430a-bec0-9243d87a78c0_pcap
[2025-05-17 21:44:05,157] INFO in routes: PCAP文件大小: 1506 字节
[2025-05-17 21:44:05,158] INFO in routes: 使用直接模式命令: /usr/bin/suricata -c /etc/suricata/suricata.yaml -r /home/taoli/NIDS_ByTaoLi/backend/uploads/856879a9-aa0c-430a-bec0-9243d87a78c0_pcap -v -k none
[2025-05-17 21:44:05,233] INFO in routes: Suricata输出: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 2
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed,...
[2025-05-17 21:44:05,233] INFO in routes: Suricata返回码: 0
[2025-05-17 21:44:05,233] INFO in routes: 从/var/log/suricata/eve.json复制结果到/home/taoli/NIDS_ByTaoLi/backend/uploads/856879a9-aa0c-430a-bec0-9243d87a78c0_eve.json
[2025-05-17 21:44:05,234] INFO in routes: 处理eve.json文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/856879a9-aa0c-430a-bec0-9243d87a78c0_eve.json, 大小: 1020872 字节
[2025-05-17 21:44:05,234] INFO in routes: Eve.json前几行内容:
[2025-05-17 21:44:05,234] INFO in routes: 行 1: {"timestamp":"2025-05-17T18:24:39.067554+0800","flow_id":1978993307944531,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":48522,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":42719,"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"A","tx_id":0,"opcode":0}}...
[2025-05-17 21:44:05,234] INFO in routes: 行 2: {"timestamp":"2025-05-17T18:24:39.067777+0800","flow_id":1979950945253980,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":54214,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":24352,"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"AAAA","tx_id":0,"opcode":0}}...
[2025-05-17 21:44:05,234] INFO in routes: 行 3: {"timestamp":"2025-05-17T18:24:39.074028+0800","flow_id":1978993307944531,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":48522,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":42719,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"A","rcode":"NOERROR","answers":[{"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"CNAME","ttl":30,"rdata":"mirrors.tuna.t...
[2025-05-17 21:44:05,234] INFO in routes: 行 4: {"timestamp":"2025-05-17T18:24:39.074734+0800","flow_id":1979950945253980,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":54214,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":24352,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"AAAA","rcode":"NOERROR","answers":[{"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"CNAME","ttl":171,"rdata":"mirrors.tu...
[2025-05-17 21:44:05,234] INFO in routes: 行 5: {"timestamp":"2025-05-17T18:24:39.273815+0800","flow_id":2020455330372048,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":37523,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":47356,"rrname":"mirrors.aliyun.com","rrtype":"A","tx_id":0,"opcode":0}}...
[2025-05-17 21:44:05,235] INFO in routes: 行 6: {"timestamp":"2025-05-17T18:24:39.274046+0800","flow_id":2021445079687099,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":35878,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":56505,"rrname":"mirrors.aliyun.com","rrtype":"AAAA","tx_id":0,"opcode":0}}...
[2025-05-17 21:44:05,235] INFO in routes: 行 7: {"timestamp":"2025-05-17T18:24:39.280764+0800","flow_id":2020455330372048,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":37523,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":47356,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"mirrors.aliyun.com","rrtype":"A","rcode":"NOERROR","answers":[{"rrname":"mirrors.aliyun.com","rrtype":"CNAME","ttl":30,"rdata":"mirrors.aliyun.com.w.alikunl...
[2025-05-17 21:44:05,235] INFO in routes: 行 8: {"timestamp":"2025-05-17T18:24:39.281564+0800","flow_id":2021445079687099,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":35878,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":56505,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"mirrors.aliyun.com","rrtype":"AAAA","rcode":"NOERROR","answers":[{"rrname":"mirrors.aliyun.com","rrtype":"CNAME","ttl":41,"rdata":"mirrors.aliyun.com.w.alik...
[2025-05-17 21:44:05,235] INFO in routes: 行 9: {"timestamp":"2025-05-17T18:24:39.281812+0800","flow_id":2054802404068717,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":35829,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":42539,"rrname":"mirrors.aliyun.com.w.alikunlun.com","rrtype":"AAAA","tx_id":0,"opcode":0}}...
[2025-05-17 21:44:05,236] INFO in routes: 行 10: {"timestamp":"2025-05-17T18:24:39.306178+0800","flow_id":2054802404068717,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":35829,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":42539,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"mirrors.aliyun.com.w.alikunlun.com","rrtype":"AAAA","rcode":"NOERROR","authorities":[{"rrname":"w.alikunlun.com","rrtype":"SOA","ttl":89,"soa":{"mname":"ns3...
[2025-05-17 21:44:05,244] WARNING in routes: 处理了1923行，发现0个告警，但没有保存任何告警记录
[2025-05-17 21:44:05,245] WARNING in routes: 未发现告警，可能是没有匹配的规则或PCAP文件内容没有触发告警
[2025-05-17 21:44:05,245] INFO in routes: 保留eve.json文件用于分析调试: /home/taoli/NIDS_ByTaoLi/backend/uploads/856879a9-aa0c-430a-bec0-9243d87a78c0_eve.json
[2025-05-17 21:44:05,245] INFO in routes: 已删除PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/856879a9-aa0c-430a-bec0-9243d87a78c0_pcap.bak
[2025-05-17 21:48:10,088] INFO in __init__: 应用已启动
[2025-05-17 21:48:10,486] INFO in __init__: 应用已启动
[2025-05-17 21:48:48,814] INFO in routes: 上传目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 21:48:48,814] INFO in routes: 保存PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/f39fe5b4-27bb-47f9-8e7a-1f66999f4296_Metasploit_Payload.pcap
[2025-05-17 21:48:48,815] INFO in routes: PCAP文件已保存: /home/taoli/NIDS_ByTaoLi/backend/uploads/f39fe5b4-27bb-47f9-8e7a-1f66999f4296_Metasploit_Payload.pcap, 大小: 537631 字节
[2025-05-17 21:48:48,823] INFO in routes: 开始分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/f39fe5b4-27bb-47f9-8e7a-1f66999f4296_Metasploit_Payload.pcap, 输出目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 21:48:48,824] INFO in routes: 已创建PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/f39fe5b4-27bb-47f9-8e7a-1f66999f4296_Metasploit_Payload.pcap.bak
[2025-05-17 21:48:48,824] INFO in routes: 使用Suricata分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/f39fe5b4-27bb-47f9-8e7a-1f66999f4296_Metasploit_Payload.pcap
[2025-05-17 21:48:48,824] INFO in routes: PCAP文件大小: 537631 字节
[2025-05-17 21:48:48,824] INFO in routes: 使用直接模式命令: /usr/bin/suricata -c /etc/suricata/suricata.yaml -r /home/taoli/NIDS_ByTaoLi/backend/uploads/f39fe5b4-27bb-47f9-8e7a-1f66999f4296_Metasploit_Payload.pcap -v -k none
[2025-05-17 21:48:48,933] INFO in routes: Suricata输出: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 4
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed,...
[2025-05-17 21:48:48,934] INFO in routes: Suricata返回码: 0
[2025-05-17 21:48:48,934] INFO in routes: 从/var/log/suricata/eve.json复制结果到/home/taoli/NIDS_ByTaoLi/backend/uploads/f39fe5b4-27bb-47f9-8e7a-1f66999f4296_eve.json
[2025-05-17 21:48:48,937] INFO in routes: 处理eve.json文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/f39fe5b4-27bb-47f9-8e7a-1f66999f4296_eve.json, 大小: 1032741 字节
[2025-05-17 21:48:48,937] INFO in routes: Eve.json前几行内容:
[2025-05-17 21:48:48,937] INFO in routes: 行 1: {"timestamp":"2025-05-17T18:24:39.067554+0800","flow_id":1978993307944531,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":48522,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":42719,"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"A","tx_id":0,"opcode":0}}...
[2025-05-17 21:48:48,937] INFO in routes: 行 2: {"timestamp":"2025-05-17T18:24:39.067777+0800","flow_id":1979950945253980,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":54214,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":24352,"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"AAAA","tx_id":0,"opcode":0}}...
[2025-05-17 21:48:48,937] INFO in routes: 行 3: {"timestamp":"2025-05-17T18:24:39.074028+0800","flow_id":1978993307944531,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":48522,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":42719,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"A","rcode":"NOERROR","answers":[{"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"CNAME","ttl":30,"rdata":"mirrors.tuna.t...
[2025-05-17 21:48:48,938] INFO in routes: 行 4: {"timestamp":"2025-05-17T18:24:39.074734+0800","flow_id":1979950945253980,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":54214,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":24352,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"AAAA","rcode":"NOERROR","answers":[{"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"CNAME","ttl":171,"rdata":"mirrors.tu...
[2025-05-17 21:48:48,938] INFO in routes: 行 5: {"timestamp":"2025-05-17T18:24:39.273815+0800","flow_id":2020455330372048,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":37523,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":47356,"rrname":"mirrors.aliyun.com","rrtype":"A","tx_id":0,"opcode":0}}...
[2025-05-17 21:48:48,938] INFO in routes: 行 6: {"timestamp":"2025-05-17T18:24:39.274046+0800","flow_id":2021445079687099,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":35878,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":56505,"rrname":"mirrors.aliyun.com","rrtype":"AAAA","tx_id":0,"opcode":0}}...
[2025-05-17 21:48:48,938] INFO in routes: 行 7: {"timestamp":"2025-05-17T18:24:39.280764+0800","flow_id":2020455330372048,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":37523,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":47356,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"mirrors.aliyun.com","rrtype":"A","rcode":"NOERROR","answers":[{"rrname":"mirrors.aliyun.com","rrtype":"CNAME","ttl":30,"rdata":"mirrors.aliyun.com.w.alikunl...
[2025-05-17 21:48:48,938] INFO in routes: 行 8: {"timestamp":"2025-05-17T18:24:39.281564+0800","flow_id":2021445079687099,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":35878,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":56505,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"mirrors.aliyun.com","rrtype":"AAAA","rcode":"NOERROR","answers":[{"rrname":"mirrors.aliyun.com","rrtype":"CNAME","ttl":41,"rdata":"mirrors.aliyun.com.w.alik...
[2025-05-17 21:48:48,938] INFO in routes: 行 9: {"timestamp":"2025-05-17T18:24:39.281812+0800","flow_id":2054802404068717,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":35829,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":42539,"rrname":"mirrors.aliyun.com.w.alikunlun.com","rrtype":"AAAA","tx_id":0,"opcode":0}}...
[2025-05-17 21:48:48,938] INFO in routes: 行 10: {"timestamp":"2025-05-17T18:24:39.306178+0800","flow_id":2054802404068717,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":35829,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":42539,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"mirrors.aliyun.com.w.alikunlun.com","rrtype":"AAAA","rcode":"NOERROR","authorities":[{"rrname":"w.alikunlun.com","rrtype":"SOA","ttl":89,"soa":{"mname":"ns3...
[2025-05-17 21:48:48,946] WARNING in routes: 处理了1952行，发现0个告警，但没有保存任何告警记录
[2025-05-17 21:48:48,946] WARNING in routes: 未发现告警，可能是没有匹配的规则或PCAP文件内容没有触发告警
[2025-05-17 21:48:48,946] INFO in routes: 保留eve.json文件用于分析调试: /home/taoli/NIDS_ByTaoLi/backend/uploads/f39fe5b4-27bb-47f9-8e7a-1f66999f4296_eve.json
[2025-05-17 21:48:48,946] INFO in routes: 已删除PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/f39fe5b4-27bb-47f9-8e7a-1f66999f4296_Metasploit_Payload.pcap.bak
[2025-05-17 22:00:19,305] INFO in __init__: 应用已启动
[2025-05-17 22:00:19,628] INFO in __init__: 应用已启动
[2025-05-17 22:00:40,379] INFO in routes: 上传目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 22:00:40,380] INFO in routes: 保存PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/bbd31ae5-1c4b-4002-88f2-4283ac7b2c2a_wifi.pcap
[2025-05-17 22:00:40,380] INFO in routes: PCAP文件已保存: /home/taoli/NIDS_ByTaoLi/backend/uploads/bbd31ae5-1c4b-4002-88f2-4283ac7b2c2a_wifi.pcap, 大小: 509929 字节
[2025-05-17 22:00:40,382] INFO in routes: 开始分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/bbd31ae5-1c4b-4002-88f2-4283ac7b2c2a_wifi.pcap, 输出目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 22:00:40,382] INFO in routes: 已创建PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/bbd31ae5-1c4b-4002-88f2-4283ac7b2c2a_wifi.pcap.bak
[2025-05-17 22:00:40,382] INFO in routes: 使用Suricata分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/bbd31ae5-1c4b-4002-88f2-4283ac7b2c2a_wifi.pcap
[2025-05-17 22:00:40,382] INFO in routes: PCAP文件大小: 509929 字节
[2025-05-17 22:00:40,383] INFO in routes: 使用直接模式命令: /usr/bin/suricata -c /etc/suricata/suricata.yaml -r /home/taoli/NIDS_ByTaoLi/backend/uploads/bbd31ae5-1c4b-4002-88f2-4283ac7b2c2a_wifi.pcap -v -k none
[2025-05-17 22:00:40,467] INFO in routes: Suricata输出: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 4
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed,...
[2025-05-17 22:00:40,468] INFO in routes: Suricata错误: Error: pcap: datalink type 105 not (yet) supported in module PcapFile.
Error: pcap: pcap file reader thread failed to initialize
...
[2025-05-17 22:00:40,468] INFO in routes: Suricata返回码: 0
[2025-05-17 22:00:40,468] INFO in routes: 从/var/log/suricata/eve.json复制结果到/home/taoli/NIDS_ByTaoLi/backend/uploads/bbd31ae5-1c4b-4002-88f2-4283ac7b2c2a_eve.json
[2025-05-17 22:00:40,469] INFO in routes: 处理eve.json文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/bbd31ae5-1c4b-4002-88f2-4283ac7b2c2a_eve.json, 大小: 1032741 字节
[2025-05-17 22:00:40,469] INFO in routes: Eve.json前几行内容:
[2025-05-17 22:00:40,469] INFO in routes: 行 1: {"timestamp":"2025-05-17T18:24:39.067554+0800","flow_id":1978993307944531,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":48522,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":42719,"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"A","tx_id":0,"opcode":0}}...
[2025-05-17 22:00:40,470] INFO in routes: 行 2: {"timestamp":"2025-05-17T18:24:39.067777+0800","flow_id":1979950945253980,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":54214,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":24352,"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"AAAA","tx_id":0,"opcode":0}}...
[2025-05-17 22:00:40,470] INFO in routes: 行 3: {"timestamp":"2025-05-17T18:24:39.074028+0800","flow_id":1978993307944531,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":48522,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":42719,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"A","rcode":"NOERROR","answers":[{"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"CNAME","ttl":30,"rdata":"mirrors.tuna.t...
[2025-05-17 22:00:40,470] INFO in routes: 行 4: {"timestamp":"2025-05-17T18:24:39.074734+0800","flow_id":1979950945253980,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":54214,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":24352,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"AAAA","rcode":"NOERROR","answers":[{"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"CNAME","ttl":171,"rdata":"mirrors.tu...
[2025-05-17 22:00:40,470] INFO in routes: 行 5: {"timestamp":"2025-05-17T18:24:39.273815+0800","flow_id":2020455330372048,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":37523,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":47356,"rrname":"mirrors.aliyun.com","rrtype":"A","tx_id":0,"opcode":0}}...
[2025-05-17 22:00:40,470] INFO in routes: 行 6: {"timestamp":"2025-05-17T18:24:39.274046+0800","flow_id":2021445079687099,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":35878,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":56505,"rrname":"mirrors.aliyun.com","rrtype":"AAAA","tx_id":0,"opcode":0}}...
[2025-05-17 22:00:40,470] INFO in routes: 行 7: {"timestamp":"2025-05-17T18:24:39.280764+0800","flow_id":2020455330372048,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":37523,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":47356,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"mirrors.aliyun.com","rrtype":"A","rcode":"NOERROR","answers":[{"rrname":"mirrors.aliyun.com","rrtype":"CNAME","ttl":30,"rdata":"mirrors.aliyun.com.w.alikunl...
[2025-05-17 22:00:40,470] INFO in routes: 行 8: {"timestamp":"2025-05-17T18:24:39.281564+0800","flow_id":2021445079687099,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":35878,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":56505,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"mirrors.aliyun.com","rrtype":"AAAA","rcode":"NOERROR","answers":[{"rrname":"mirrors.aliyun.com","rrtype":"CNAME","ttl":41,"rdata":"mirrors.aliyun.com.w.alik...
[2025-05-17 22:00:40,470] INFO in routes: 行 9: {"timestamp":"2025-05-17T18:24:39.281812+0800","flow_id":2054802404068717,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":35829,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":42539,"rrname":"mirrors.aliyun.com.w.alikunlun.com","rrtype":"AAAA","tx_id":0,"opcode":0}}...
[2025-05-17 22:00:40,470] INFO in routes: 行 10: {"timestamp":"2025-05-17T18:24:39.306178+0800","flow_id":2054802404068717,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":35829,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":42539,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"mirrors.aliyun.com.w.alikunlun.com","rrtype":"AAAA","rcode":"NOERROR","authorities":[{"rrname":"w.alikunlun.com","rrtype":"SOA","ttl":89,"soa":{"mname":"ns3...
[2025-05-17 22:00:40,478] WARNING in routes: 处理了1952行，发现0个告警，但没有保存任何告警记录
[2025-05-17 22:00:40,479] WARNING in routes: 未发现告警，可能是没有匹配的规则或PCAP文件内容没有触发告警
[2025-05-17 22:00:40,479] INFO in routes: 保留eve.json文件用于分析调试: /home/taoli/NIDS_ByTaoLi/backend/uploads/bbd31ae5-1c4b-4002-88f2-4283ac7b2c2a_eve.json
[2025-05-17 22:00:40,479] INFO in routes: 已删除PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/bbd31ae5-1c4b-4002-88f2-4283ac7b2c2a_wifi.pcap.bak
[2025-05-17 22:11:19,455] INFO in __init__: 应用已启动
[2025-05-17 22:12:03,750] INFO in __init__: 应用已启动
[2025-05-17 22:12:38,107] INFO in __init__: 应用已启动
[2025-05-17 22:13:11,716] INFO in __init__: 应用已启动
[2025-05-17 22:13:52,544] INFO in __init__: 应用已启动
[2025-05-17 22:13:52,882] INFO in __init__: 应用已启动
[2025-05-17 22:13:56,935] ERROR in routes: 获取PCAP文件列表失败: (pymysql.err.ProgrammingError) (1146, "Table 'nids_db.pcap_files' doesn't exist")
[SQL: SELECT pcap_files.id AS pcap_files_id, pcap_files.filename AS pcap_files_filename, pcap_files.original_filename AS pcap_files_original_filename, pcap_files.upload_time AS pcap_files_upload_time, pcap_files.file_size AS pcap_files_file_size, pcap_files.processed AS pcap_files_processed, pcap_files.alert_count AS pcap_files_alert_count 
FROM pcap_files ORDER BY pcap_files.upload_time DESC 
 LIMIT %(param_1)s, %(param_2)s]
[parameters: {'param_1': 0, 'param_2': 10}]
(Background on this error at: https://sqlalche.me/e/14/f405)
Traceback (most recent call last):
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/cursors.py", line 148, in execute
    result = self._query(query)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/cursors.py", line 310, in _query
    conn.query(q)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_query_result
    result.read()
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 725, in _read_packet
    packet.raise_for_error()
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1146, "Table 'nids_db.pcap_files' doesn't exist")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/taoli/NIDS_ByTaoLi/backend/app/pcap/routes.py", line 752, in list_pcap_files
    pagination = PcapFile.query.order_by(
  File "/home/taoli/.local/lib/python3.10/site-packages/flask_sqlalchemy/__init__.py", line 534, in paginate
    items = self.limit(per_page).offset((page - 1) * per_page).all()
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2773, in all
    return self._iter().all()
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2916, in _iter
    result = self.session.execute(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1714, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/cursors.py", line 148, in execute
    result = self._query(query)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/cursors.py", line 310, in _query
    conn.query(q)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_query_result
    result.read()
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 725, in _read_packet
    packet.raise_for_error()
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1146, "Table 'nids_db.pcap_files' doesn't exist")
[SQL: SELECT pcap_files.id AS pcap_files_id, pcap_files.filename AS pcap_files_filename, pcap_files.original_filename AS pcap_files_original_filename, pcap_files.upload_time AS pcap_files_upload_time, pcap_files.file_size AS pcap_files_file_size, pcap_files.processed AS pcap_files_processed, pcap_files.alert_count AS pcap_files_alert_count 
FROM pcap_files ORDER BY pcap_files.upload_time DESC 
 LIMIT %(param_1)s, %(param_2)s]
[parameters: {'param_1': 0, 'param_2': 10}]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-05-17 22:13:56,938] ERROR in routes: 获取PCAP文件列表失败: (pymysql.err.ProgrammingError) (1146, "Table 'nids_db.pcap_files' doesn't exist")
[SQL: SELECT pcap_files.id AS pcap_files_id, pcap_files.filename AS pcap_files_filename, pcap_files.original_filename AS pcap_files_original_filename, pcap_files.upload_time AS pcap_files_upload_time, pcap_files.file_size AS pcap_files_file_size, pcap_files.processed AS pcap_files_processed, pcap_files.alert_count AS pcap_files_alert_count 
FROM pcap_files ORDER BY pcap_files.upload_time DESC 
 LIMIT %(param_1)s, %(param_2)s]
[parameters: {'param_1': 0, 'param_2': 10}]
(Background on this error at: https://sqlalche.me/e/14/f405)
Traceback (most recent call last):
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/cursors.py", line 148, in execute
    result = self._query(query)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/cursors.py", line 310, in _query
    conn.query(q)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_query_result
    result.read()
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 725, in _read_packet
    packet.raise_for_error()
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1146, "Table 'nids_db.pcap_files' doesn't exist")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/taoli/NIDS_ByTaoLi/backend/app/pcap/routes.py", line 752, in list_pcap_files
    pagination = PcapFile.query.order_by(
  File "/home/taoli/.local/lib/python3.10/site-packages/flask_sqlalchemy/__init__.py", line 534, in paginate
    items = self.limit(per_page).offset((page - 1) * per_page).all()
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2773, in all
    return self._iter().all()
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2916, in _iter
    result = self.session.execute(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1714, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/cursors.py", line 148, in execute
    result = self._query(query)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/cursors.py", line 310, in _query
    conn.query(q)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_query_result
    result.read()
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 725, in _read_packet
    packet.raise_for_error()
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1146, "Table 'nids_db.pcap_files' doesn't exist")
[SQL: SELECT pcap_files.id AS pcap_files_id, pcap_files.filename AS pcap_files_filename, pcap_files.original_filename AS pcap_files_original_filename, pcap_files.upload_time AS pcap_files_upload_time, pcap_files.file_size AS pcap_files_file_size, pcap_files.processed AS pcap_files_processed, pcap_files.alert_count AS pcap_files_alert_count 
FROM pcap_files ORDER BY pcap_files.upload_time DESC 
 LIMIT %(param_1)s, %(param_2)s]
[parameters: {'param_1': 0, 'param_2': 10}]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-05-17 22:14:01,673] INFO in routes: 上传目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 22:14:01,673] INFO in routes: 保存PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/0ff4d612-9f70-4968-959d-7ee55e148073_Metasploit_Payload.pcap
[2025-05-17 22:14:01,674] INFO in routes: PCAP文件已保存: /home/taoli/NIDS_ByTaoLi/backend/uploads/0ff4d612-9f70-4968-959d-7ee55e148073_Metasploit_Payload.pcap, 大小: 537631 字节
[2025-05-17 22:14:01,677] ERROR in routes: 处理PCAP文件时出错: (pymysql.err.ProgrammingError) (1146, "Table 'nids_db.pcap_files' doesn't exist")
[SQL: INSERT INTO pcap_files (filename, original_filename, upload_time, file_size, processed, alert_count) VALUES (%(filename)s, %(original_filename)s, %(upload_time)s, %(file_size)s, %(processed)s, %(alert_count)s)]
[parameters: {'filename': '0ff4d612-9f70-4968-959d-7ee55e148073_Metasploit_Payload.pcap', 'original_filename': 'Metasploit_Payload.pcap', 'upload_time': datetime.datetime(2025, 5, 17, 22, 14, 1, 674909), 'file_size': 537631, 'processed': 0, 'alert_count': 0}]
(Background on this error at: https://sqlalche.me/e/14/f405)
Traceback (most recent call last):
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/cursors.py", line 148, in execute
    result = self._query(query)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/cursors.py", line 310, in _query
    conn.query(q)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_query_result
    result.read()
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 725, in _read_packet
    packet.raise_for_error()
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1146, "Table 'nids_db.pcap_files' doesn't exist")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/taoli/NIDS_ByTaoLi/backend/app/pcap/routes.py", line 628, in upload_pcap
    db.session.commit()
  File "<string>", line 2, in commit
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1451, in commit
    self._transaction.commit(_to_root=self.future)
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 829, in commit
    self._prepare_impl()
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 808, in _prepare_impl
    self.session.flush()
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 3444, in flush
    self._flush(objects)
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 3583, in _flush
    with util.safe_reraise():
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 3544, in _flush
    flush_context.execute()
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 456, in execute
    rec.execute(self)
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 630, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 245, in save_obj
    _emit_insert_statements(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 1238, in _emit_insert_statements
    result = connection._execute_20(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/cursors.py", line 148, in execute
    result = self._query(query)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/cursors.py", line 310, in _query
    conn.query(q)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_query_result
    result.read()
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 725, in _read_packet
    packet.raise_for_error()
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1146, "Table 'nids_db.pcap_files' doesn't exist")
[SQL: INSERT INTO pcap_files (filename, original_filename, upload_time, file_size, processed, alert_count) VALUES (%(filename)s, %(original_filename)s, %(upload_time)s, %(file_size)s, %(processed)s, %(alert_count)s)]
[parameters: {'filename': '0ff4d612-9f70-4968-959d-7ee55e148073_Metasploit_Payload.pcap', 'original_filename': 'Metasploit_Payload.pcap', 'upload_time': datetime.datetime(2025, 5, 17, 22, 14, 1, 674909), 'file_size': 537631, 'processed': 0, 'alert_count': 0}]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-05-17 22:16:10,440] INFO in __init__: 应用已启动
[2025-05-17 22:16:10,733] INFO in __init__: 应用已启动
[2025-05-17 22:16:13,530] ERROR in routes: 获取PCAP文件列表失败: (pymysql.err.ProgrammingError) (1146, "Table 'nids_db.pcap_files' doesn't exist")
[SQL: SELECT pcap_files.id AS pcap_files_id, pcap_files.filename AS pcap_files_filename, pcap_files.original_filename AS pcap_files_original_filename, pcap_files.upload_time AS pcap_files_upload_time, pcap_files.file_size AS pcap_files_file_size, pcap_files.processed AS pcap_files_processed, pcap_files.alert_count AS pcap_files_alert_count 
FROM pcap_files ORDER BY pcap_files.upload_time DESC 
 LIMIT %(param_1)s, %(param_2)s]
[parameters: {'param_1': 0, 'param_2': 10}]
(Background on this error at: https://sqlalche.me/e/14/f405)
Traceback (most recent call last):
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/cursors.py", line 148, in execute
    result = self._query(query)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/cursors.py", line 310, in _query
    conn.query(q)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_query_result
    result.read()
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 725, in _read_packet
    packet.raise_for_error()
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1146, "Table 'nids_db.pcap_files' doesn't exist")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/taoli/NIDS_ByTaoLi/backend/app/pcap/routes.py", line 752, in list_pcap_files
    pagination = PcapFile.query.order_by(
  File "/home/taoli/.local/lib/python3.10/site-packages/flask_sqlalchemy/__init__.py", line 534, in paginate
    items = self.limit(per_page).offset((page - 1) * per_page).all()
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2773, in all
    return self._iter().all()
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2916, in _iter
    result = self.session.execute(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1714, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/cursors.py", line 148, in execute
    result = self._query(query)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/cursors.py", line 310, in _query
    conn.query(q)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_query_result
    result.read()
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 725, in _read_packet
    packet.raise_for_error()
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1146, "Table 'nids_db.pcap_files' doesn't exist")
[SQL: SELECT pcap_files.id AS pcap_files_id, pcap_files.filename AS pcap_files_filename, pcap_files.original_filename AS pcap_files_original_filename, pcap_files.upload_time AS pcap_files_upload_time, pcap_files.file_size AS pcap_files_file_size, pcap_files.processed AS pcap_files_processed, pcap_files.alert_count AS pcap_files_alert_count 
FROM pcap_files ORDER BY pcap_files.upload_time DESC 
 LIMIT %(param_1)s, %(param_2)s]
[parameters: {'param_1': 0, 'param_2': 10}]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-05-17 22:16:13,542] ERROR in routes: 获取PCAP文件列表失败: (pymysql.err.ProgrammingError) (1146, "Table 'nids_db.pcap_files' doesn't exist")
[SQL: SELECT pcap_files.id AS pcap_files_id, pcap_files.filename AS pcap_files_filename, pcap_files.original_filename AS pcap_files_original_filename, pcap_files.upload_time AS pcap_files_upload_time, pcap_files.file_size AS pcap_files_file_size, pcap_files.processed AS pcap_files_processed, pcap_files.alert_count AS pcap_files_alert_count 
FROM pcap_files ORDER BY pcap_files.upload_time DESC 
 LIMIT %(param_1)s, %(param_2)s]
[parameters: {'param_1': 0, 'param_2': 10}]
(Background on this error at: https://sqlalche.me/e/14/f405)
Traceback (most recent call last):
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/cursors.py", line 148, in execute
    result = self._query(query)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/cursors.py", line 310, in _query
    conn.query(q)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_query_result
    result.read()
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 725, in _read_packet
    packet.raise_for_error()
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1146, "Table 'nids_db.pcap_files' doesn't exist")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/taoli/NIDS_ByTaoLi/backend/app/pcap/routes.py", line 752, in list_pcap_files
    pagination = PcapFile.query.order_by(
  File "/home/taoli/.local/lib/python3.10/site-packages/flask_sqlalchemy/__init__.py", line 534, in paginate
    items = self.limit(per_page).offset((page - 1) * per_page).all()
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2773, in all
    return self._iter().all()
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2916, in _iter
    result = self.session.execute(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1714, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/cursors.py", line 148, in execute
    result = self._query(query)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/cursors.py", line 310, in _query
    conn.query(q)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_query_result
    result.read()
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 725, in _read_packet
    packet.raise_for_error()
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1146, "Table 'nids_db.pcap_files' doesn't exist")
[SQL: SELECT pcap_files.id AS pcap_files_id, pcap_files.filename AS pcap_files_filename, pcap_files.original_filename AS pcap_files_original_filename, pcap_files.upload_time AS pcap_files_upload_time, pcap_files.file_size AS pcap_files_file_size, pcap_files.processed AS pcap_files_processed, pcap_files.alert_count AS pcap_files_alert_count 
FROM pcap_files ORDER BY pcap_files.upload_time DESC 
 LIMIT %(param_1)s, %(param_2)s]
[parameters: {'param_1': 0, 'param_2': 10}]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-05-17 22:16:18,140] INFO in routes: 上传目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 22:16:18,140] INFO in routes: 保存PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/e8e4cbc4-c7fc-4730-9680-3e22028586fd_pcap
[2025-05-17 22:16:18,140] INFO in routes: PCAP文件已保存: /home/taoli/NIDS_ByTaoLi/backend/uploads/e8e4cbc4-c7fc-4730-9680-3e22028586fd_pcap, 大小: 1506 字节
[2025-05-17 22:16:18,143] ERROR in routes: 处理PCAP文件时出错: (pymysql.err.ProgrammingError) (1146, "Table 'nids_db.pcap_files' doesn't exist")
[SQL: INSERT INTO pcap_files (filename, original_filename, upload_time, file_size, processed, alert_count) VALUES (%(filename)s, %(original_filename)s, %(upload_time)s, %(file_size)s, %(processed)s, %(alert_count)s)]
[parameters: {'filename': 'e8e4cbc4-c7fc-4730-9680-3e22028586fd_pcap', 'original_filename': 'pcap', 'upload_time': datetime.datetime(2025, 5, 17, 22, 16, 18, 141062), 'file_size': 1506, 'processed': 0, 'alert_count': 0}]
(Background on this error at: https://sqlalche.me/e/14/f405)
Traceback (most recent call last):
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/cursors.py", line 148, in execute
    result = self._query(query)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/cursors.py", line 310, in _query
    conn.query(q)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_query_result
    result.read()
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 725, in _read_packet
    packet.raise_for_error()
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1146, "Table 'nids_db.pcap_files' doesn't exist")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/taoli/NIDS_ByTaoLi/backend/app/pcap/routes.py", line 628, in upload_pcap
    db.session.commit()
  File "<string>", line 2, in commit
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1451, in commit
    self._transaction.commit(_to_root=self.future)
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 829, in commit
    self._prepare_impl()
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 808, in _prepare_impl
    self.session.flush()
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 3444, in flush
    self._flush(objects)
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 3583, in _flush
    with util.safe_reraise():
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 3544, in _flush
    flush_context.execute()
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 456, in execute
    rec.execute(self)
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 630, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 245, in save_obj
    _emit_insert_statements(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 1238, in _emit_insert_statements
    result = connection._execute_20(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1572, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "/home/taoli/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/cursors.py", line 148, in execute
    result = self._query(query)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/cursors.py", line 310, in _query
    conn.query(q)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 775, in _read_query_result
    result.read()
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/connections.py", line 725, in _read_packet
    packet.raise_for_error()
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/home/taoli/.local/lib/python3.10/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1146, "Table 'nids_db.pcap_files' doesn't exist")
[SQL: INSERT INTO pcap_files (filename, original_filename, upload_time, file_size, processed, alert_count) VALUES (%(filename)s, %(original_filename)s, %(upload_time)s, %(file_size)s, %(processed)s, %(alert_count)s)]
[parameters: {'filename': 'e8e4cbc4-c7fc-4730-9680-3e22028586fd_pcap', 'original_filename': 'pcap', 'upload_time': datetime.datetime(2025, 5, 17, 22, 16, 18, 141062), 'file_size': 1506, 'processed': 0, 'alert_count': 0}]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-05-17 22:17:50,606] INFO in __init__: 应用已启动
[2025-05-17 22:18:15,648] INFO in __init__: 应用已启动
[2025-05-17 22:18:16,041] INFO in __init__: 应用已启动
[2025-05-17 22:28:15,264] INFO in __init__: 应用已启动
[2025-05-17 22:28:57,048] INFO in __init__: 应用已启动
[2025-05-17 22:28:57,300] INFO in __init__: 应用已启动
[2025-05-17 22:31:09,510] INFO in __init__: 应用已启动
[2025-05-17 22:31:09,869] INFO in __init__: 应用已启动
[2025-05-17 22:35:13,852] INFO in __init__: 应用已启动
[2025-05-17 22:41:47,673] INFO in routes: 上传目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 22:41:47,674] INFO in routes: 保存PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/f08ca043-f217-4295-bb53-01c72c26c15e_Apache_Struts.pcap
[2025-05-17 22:41:47,675] INFO in routes: PCAP文件已保存: /home/taoli/NIDS_ByTaoLi/backend/uploads/f08ca043-f217-4295-bb53-01c72c26c15e_Apache_Struts.pcap, 大小: 3746 字节
[2025-05-17 22:41:47,689] INFO in routes: 已创建PCAP文件记录: ID=4, 文件名=f08ca043-f217-4295-bb53-01c72c26c15e_Apache_Struts.pcap
[2025-05-17 22:41:47,692] INFO in routes: 开始分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/f08ca043-f217-4295-bb53-01c72c26c15e_Apache_Struts.pcap, 输出目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 22:41:47,692] INFO in routes: 已创建PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/f08ca043-f217-4295-bb53-01c72c26c15e_Apache_Struts.pcap.bak
[2025-05-17 22:41:47,692] INFO in routes: 使用Suricata分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/f08ca043-f217-4295-bb53-01c72c26c15e_Apache_Struts.pcap
[2025-05-17 22:41:47,692] INFO in routes: PCAP文件大小: 3746 字节
[2025-05-17 22:41:47,692] INFO in routes: 使用直接模式命令: /usr/bin/suricata -c /etc/suricata/suricata.yaml -r /home/taoli/NIDS_ByTaoLi/backend/uploads/f08ca043-f217-4295-bb53-01c72c26c15e_Apache_Struts.pcap -v -k none
[2025-05-17 22:41:47,774] INFO in routes: Suricata输出: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 4
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed,...
[2025-05-17 22:41:47,774] INFO in routes: Suricata返回码: 0
[2025-05-17 22:41:47,774] INFO in routes: 从/var/log/suricata/eve.json复制结果到/home/taoli/NIDS_ByTaoLi/backend/uploads/f08ca043-f217-4295-bb53-01c72c26c15e_eve.json
[2025-05-17 22:41:47,778] INFO in routes: 处理eve.json文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/f08ca043-f217-4295-bb53-01c72c26c15e_eve.json, 大小: 1212667 字节
[2025-05-17 22:41:47,778] INFO in routes: Eve.json前几行内容:
[2025-05-17 22:41:47,778] INFO in routes: 行 1: {"timestamp":"2025-05-17T18:24:39.067554+0800","flow_id":1978993307944531,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":48522,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":42719,"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"A","tx_id":0,"opcode":0}}...
[2025-05-17 22:41:47,778] INFO in routes: 行 2: {"timestamp":"2025-05-17T18:24:39.067777+0800","flow_id":1979950945253980,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":54214,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":24352,"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"AAAA","tx_id":0,"opcode":0}}...
[2025-05-17 22:41:47,779] INFO in routes: 行 3: {"timestamp":"2025-05-17T18:24:39.074028+0800","flow_id":1978993307944531,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":48522,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":42719,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"A","rcode":"NOERROR","answers":[{"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"CNAME","ttl":30,"rdata":"mirrors.tuna.t...
[2025-05-17 22:41:47,779] INFO in routes: 行 4: {"timestamp":"2025-05-17T18:24:39.074734+0800","flow_id":1979950945253980,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":54214,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":24352,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"AAAA","rcode":"NOERROR","answers":[{"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"CNAME","ttl":171,"rdata":"mirrors.tu...
[2025-05-17 22:41:47,779] INFO in routes: 行 5: {"timestamp":"2025-05-17T18:24:39.273815+0800","flow_id":2020455330372048,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":37523,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":47356,"rrname":"mirrors.aliyun.com","rrtype":"A","tx_id":0,"opcode":0}}...
[2025-05-17 22:41:47,779] INFO in routes: 行 6: {"timestamp":"2025-05-17T18:24:39.274046+0800","flow_id":2021445079687099,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":35878,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":56505,"rrname":"mirrors.aliyun.com","rrtype":"AAAA","tx_id":0,"opcode":0}}...
[2025-05-17 22:41:47,779] INFO in routes: 行 7: {"timestamp":"2025-05-17T18:24:39.280764+0800","flow_id":2020455330372048,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":37523,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":47356,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"mirrors.aliyun.com","rrtype":"A","rcode":"NOERROR","answers":[{"rrname":"mirrors.aliyun.com","rrtype":"CNAME","ttl":30,"rdata":"mirrors.aliyun.com.w.alikunl...
[2025-05-17 22:41:47,779] INFO in routes: 行 8: {"timestamp":"2025-05-17T18:24:39.281564+0800","flow_id":2021445079687099,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":35878,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":56505,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"mirrors.aliyun.com","rrtype":"AAAA","rcode":"NOERROR","answers":[{"rrname":"mirrors.aliyun.com","rrtype":"CNAME","ttl":41,"rdata":"mirrors.aliyun.com.w.alik...
[2025-05-17 22:41:47,779] INFO in routes: 行 9: {"timestamp":"2025-05-17T18:24:39.281812+0800","flow_id":2054802404068717,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":35829,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":42539,"rrname":"mirrors.aliyun.com.w.alikunlun.com","rrtype":"AAAA","tx_id":0,"opcode":0}}...
[2025-05-17 22:41:47,779] INFO in routes: 行 10: {"timestamp":"2025-05-17T18:24:39.306178+0800","flow_id":2054802404068717,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":35829,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":42539,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"mirrors.aliyun.com.w.alikunlun.com","rrtype":"AAAA","rcode":"NOERROR","authorities":[{"rrname":"w.alikunlun.com","rrtype":"SOA","ttl":89,"soa":{"mname":"ns3...
[2025-05-17 22:41:47,790] WARNING in routes: 处理了2257行，发现0个告警，但没有保存任何告警记录
[2025-05-17 22:41:47,790] WARNING in routes: 未发现告警，可能是没有匹配的规则或PCAP文件内容没有触发告警
[2025-05-17 22:41:47,798] INFO in routes: 已更新PCAP文件记录: ID=4, 告警数=0
[2025-05-17 22:41:47,798] INFO in routes: 保留eve.json文件用于分析调试: /home/taoli/NIDS_ByTaoLi/backend/uploads/f08ca043-f217-4295-bb53-01c72c26c15e_eve.json
[2025-05-17 22:41:47,798] INFO in routes: 已删除PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/f08ca043-f217-4295-bb53-01c72c26c15e_Apache_Struts.pcap.bak
[2025-05-17 22:50:48,420] INFO in __init__: 应用已启动
[2025-05-17 22:56:19,769] INFO in routes: 上传目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 22:56:19,770] INFO in routes: 保存PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/bef7b74a-2d47-4b17-b977-78e563810c04_Metasploit_Payload.pcap
[2025-05-17 22:56:19,773] INFO in routes: PCAP文件已保存: /home/taoli/NIDS_ByTaoLi/backend/uploads/bef7b74a-2d47-4b17-b977-78e563810c04_Metasploit_Payload.pcap, 大小: 537631 字节
[2025-05-17 22:56:19,780] INFO in routes: 已创建PCAP文件记录: ID=4, 文件名=bef7b74a-2d47-4b17-b977-78e563810c04_Metasploit_Payload.pcap
[2025-05-17 22:56:19,782] INFO in routes: 开始分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/bef7b74a-2d47-4b17-b977-78e563810c04_Metasploit_Payload.pcap, 输出目录: /home/taoli/NIDS_ByTaoLi/backend/uploads
[2025-05-17 22:56:19,783] INFO in routes: 已创建PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/bef7b74a-2d47-4b17-b977-78e563810c04_Metasploit_Payload.pcap.bak
[2025-05-17 22:56:19,783] INFO in routes: 使用Suricata分析PCAP文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/bef7b74a-2d47-4b17-b977-78e563810c04_Metasploit_Payload.pcap
[2025-05-17 22:56:19,784] INFO in routes: PCAP文件大小: 537631 字节
[2025-05-17 22:56:19,784] INFO in routes: 使用直接模式命令: /usr/bin/suricata -c /etc/suricata/suricata.yaml -r /home/taoli/NIDS_ByTaoLi/backend/uploads/bef7b74a-2d47-4b17-b977-78e563810c04_Metasploit_Payload.pcap -v -k none
[2025-05-17 22:56:19,886] INFO in routes: Suricata输出: Notice: suricata: This is Suricata version 7.0.10 RELEASE running in USER mode
Info: cpu: CPUs/cores online: 4
Info: suricata: Setting engine mode to IDS mode by default
Info: suricata: No 'host-mode': suricata is in IDS mode, using default setting 'sniffer-only'
Info: logopenfile: eve-log output device (regular) initialized: /var/log/suricata/eve.json
Warning: counters: stats are enabled but no loggers are active
Info: detect: 1 rule files processed. 7 rules successfully loaded, 0 rules failed,...
[2025-05-17 22:56:19,887] INFO in routes: Suricata返回码: 0
[2025-05-17 22:56:19,887] INFO in routes: 从/var/log/suricata/eve.json复制结果到/home/taoli/NIDS_ByTaoLi/backend/uploads/bef7b74a-2d47-4b17-b977-78e563810c04_eve.json
[2025-05-17 22:56:19,888] INFO in routes: 处理eve.json文件: /home/taoli/NIDS_ByTaoLi/backend/uploads/bef7b74a-2d47-4b17-b977-78e563810c04_eve.json, 大小: 1242856 字节
[2025-05-17 22:56:19,888] INFO in routes: Eve.json前几行内容:
[2025-05-17 22:56:19,888] INFO in routes: 行 1: {"timestamp":"2025-05-17T18:24:39.067554+0800","flow_id":1978993307944531,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":48522,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":42719,"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"A","tx_id":0,"opcode":0}}...
[2025-05-17 22:56:19,888] INFO in routes: 行 2: {"timestamp":"2025-05-17T18:24:39.067777+0800","flow_id":1979950945253980,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":54214,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":24352,"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"AAAA","tx_id":0,"opcode":0}}...
[2025-05-17 22:56:19,888] INFO in routes: 行 3: {"timestamp":"2025-05-17T18:24:39.074028+0800","flow_id":1978993307944531,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":48522,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":42719,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"A","rcode":"NOERROR","answers":[{"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"CNAME","ttl":30,"rdata":"mirrors.tuna.t...
[2025-05-17 22:56:19,888] INFO in routes: 行 4: {"timestamp":"2025-05-17T18:24:39.074734+0800","flow_id":1979950945253980,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":54214,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":24352,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"AAAA","rcode":"NOERROR","answers":[{"rrname":"pypi.tuna.tsinghua.edu.cn","rrtype":"CNAME","ttl":171,"rdata":"mirrors.tu...
[2025-05-17 22:56:19,888] INFO in routes: 行 5: {"timestamp":"2025-05-17T18:24:39.273815+0800","flow_id":2020455330372048,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":37523,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":47356,"rrname":"mirrors.aliyun.com","rrtype":"A","tx_id":0,"opcode":0}}...
[2025-05-17 22:56:19,888] INFO in routes: 行 6: {"timestamp":"2025-05-17T18:24:39.274046+0800","flow_id":2021445079687099,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":35878,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":56505,"rrname":"mirrors.aliyun.com","rrtype":"AAAA","tx_id":0,"opcode":0}}...
[2025-05-17 22:56:19,888] INFO in routes: 行 7: {"timestamp":"2025-05-17T18:24:39.280764+0800","flow_id":2020455330372048,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":37523,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":47356,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"mirrors.aliyun.com","rrtype":"A","rcode":"NOERROR","answers":[{"rrname":"mirrors.aliyun.com","rrtype":"CNAME","ttl":30,"rdata":"mirrors.aliyun.com.w.alikunl...
[2025-05-17 22:56:19,888] INFO in routes: 行 8: {"timestamp":"2025-05-17T18:24:39.281564+0800","flow_id":2021445079687099,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":35878,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":56505,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"mirrors.aliyun.com","rrtype":"AAAA","rcode":"NOERROR","answers":[{"rrname":"mirrors.aliyun.com","rrtype":"CNAME","ttl":41,"rdata":"mirrors.aliyun.com.w.alik...
[2025-05-17 22:56:19,888] INFO in routes: 行 9: {"timestamp":"2025-05-17T18:24:39.281812+0800","flow_id":2054802404068717,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":35829,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"query","id":42539,"rrname":"mirrors.aliyun.com.w.alikunlun.com","rrtype":"AAAA","tx_id":0,"opcode":0}}...
[2025-05-17 22:56:19,888] INFO in routes: 行 10: {"timestamp":"2025-05-17T18:24:39.306178+0800","flow_id":2054802404068717,"in_iface":"ens33","event_type":"dns","src_ip":"192.168.101.29","src_port":35829,"dest_ip":"192.168.101.1","dest_port":53,"proto":"UDP","pkt_src":"wire/pcap","dns":{"version":2,"type":"answer","id":42539,"flags":"8180","qr":true,"rd":true,"ra":true,"opcode":0,"rrname":"mirrors.aliyun.com.w.alikunlun.com","rrtype":"AAAA","rcode":"NOERROR","authorities":[{"rrname":"w.alikunlun.com","rrtype":"SOA","ttl":89,"soa":{"mname":"ns3...
[2025-05-17 22:56:19,897] WARNING in routes: 处理了2308行，发现0个告警，但没有保存任何告警记录
[2025-05-17 22:56:19,897] WARNING in routes: 未发现告警，可能是没有匹配的规则或PCAP文件内容没有触发告警
[2025-05-17 22:56:19,901] INFO in routes: 已更新PCAP文件记录: ID=4, 告警数=0
[2025-05-17 22:56:19,901] INFO in routes: 保留eve.json文件用于分析调试: /home/taoli/NIDS_ByTaoLi/backend/uploads/bef7b74a-2d47-4b17-b977-78e563810c04_eve.json
[2025-05-17 22:56:19,901] INFO in routes: 已删除PCAP文件备份: /home/taoli/NIDS_ByTaoLi/backend/uploads/bef7b74a-2d47-4b17-b977-78e563810c04_Metasploit_Payload.pcap.bak
